(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([[3741],{

/***/ "FOH9":
/*!******************************************************************************************!*\
  !*** ./ui/features/assignments_show_student/react/components/CommentsTray/CommentRow.js ***!
  \******************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CommentRow; });\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_badge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @instructure/ui-badge */ \"BUHT\");\n/* harmony import */ var _instructure_ui_avatar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @instructure/ui-avatar */ \"KK4r\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _canvas_datetime_react_components_FriendlyDatetime__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/datetime/react/components/FriendlyDatetime */ \"ZDrK\");\n/* harmony import */ var _canvas_mime_react_mimeClassIconHelper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @canvas/mime/react/mimeClassIconHelper */ \"mRBd\");\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-a11y-content */ \"9+/z\");\n/* harmony import */ var _canvas_assignments_graphql_student_SubmissionComment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @canvas/assignments/graphql/student/SubmissionComment */ \"nnA0\");\n/* harmony import */ var _instructure_ui_media_player__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @instructure/ui-media-player */ \"4UDy\");\n/* harmony import */ var _instructure_ui_link__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @instructure/ui-link */ \"dlTp\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_6__[\"useScope\"])('assignments_2');\nfunction CommentRow(props) {\n  const {\n    author,\n    mediaObject,\n    read\n  } = props.comment;\n  let mediaTracks = null;\n\n  if (mediaObject) {\n    mediaObject.mediaSources.forEach(mediaSource => {\n      mediaSource.label = `${mediaSource.width}x${mediaSource.height}`;\n    });\n    mediaTracks = mediaObject === null || mediaObject === void 0 ? void 0 : mediaObject.mediaTracks.map(track => {\n      return {\n        id: track._id,\n        src: `/media_objects/${mediaObject._id}/media_tracks/${track._id}`,\n        label: track.locale,\n        type: track.kind,\n        language: track.locale\n      };\n    });\n  }\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(\"div\", {\n    className: \"comment-row-container\",\n    \"data-testid\": \"comment-row\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(\"div\", {\n    className: \"comment-avatar-container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center'\n    }\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_badge__WEBPACK_IMPORTED_MODULE_1__[\"Badge\"], {\n    margin: \"0 xx-small 0 0\",\n    theme: read ? {\n      colorPrimary: 'white'\n    } : undefined,\n    type: \"notification\",\n    standalone: true\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_avatar__WEBPACK_IMPORTED_MODULE_2__[\"Avatar\"], {\n    name: author ? author.shortName : I18n.t('Anonymous'),\n    src: author ? author.avatarUrl : '',\n    margin: \"0 small 0 0\",\n    \"data-fs-exclude\": true\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(\"div\", {\n    className: \"comment-text-comment-container\"\n  }, !read && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_8__[\"ScreenReaderContent\"], null, I18n.t('Unread')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_0__[\"Text\"], {\n    weight: \"light\",\n    size: \"small\"\n  }, author ? author.shortName : I18n.t('Anonymous'), ' ', /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_canvas_datetime_react_components_FriendlyDatetime__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n    prefix: I18n.t('at'),\n    format: I18n.t('#date.formats.full_with_weekday'),\n    dateTime: props.comment.updatedAt\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_0__[\"Text\"], {\n    color: props.comment._id === 'pending' ? 'secondary' : null,\n    wrap: \"break-word\"\n  }, props.comment.comment), props.comment.attachments.map(attachment => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_link__WEBPACK_IMPORTED_MODULE_11__[\"Link\"], {\n    key: attachment._id,\n    href: attachment.url,\n    isWithinText: false,\n    renderIcon: Object(_canvas_mime_react_mimeClassIconHelper__WEBPACK_IMPORTED_MODULE_5__[\"getIconByType\"])(attachment.mimeClass),\n    theme: {\n      mediumPaddingHorizontal: '0',\n      mediumHeight: 'normal'\n    }\n  }, attachment.displayName)), mediaObject && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_instructure_ui_media_player__WEBPACK_IMPORTED_MODULE_10__[\"MediaPlayer\"], {\n    tracks: mediaTracks,\n    sources: mediaObject.mediaSources\n  })));\n}\nCommentRow.propTypes = {\n  comment: _canvas_assignments_graphql_student_SubmissionComment__WEBPACK_IMPORTED_MODULE_9__[\"SubmissionComment\"].shape.isRequired\n};\n\n//# sourceURL=webpack:///./ui/features/assignments_show_student/react/components/CommentsTray/CommentRow.js?");

/***/ }),

/***/ "GmmD":
/*!********************************************************************!*\
  !*** ./ui/features/assignments_show_student/images/NoComments.svg ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("module.exports = __webpack_require__.p + \"3b81ca57da058a9d375d19f84101a1a6.svg\";\n\n//# sourceURL=webpack:///./ui/features/assignments_show_student/images/NoComments.svg?");

/***/ }),

/***/ "O/6P":
/*!************************************************************************************************!*\
  !*** ./ui/features/assignments_show_student/react/components/CommentsTray/CommentsTrayBody.js ***!
  \************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CommentsTrayBody; });\n/* harmony import */ var _canvas_assignments_graphql_student_Assignment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Assignment */ \"yXnT\");\n/* harmony import */ var _CommentContent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CommentContent */ \"xpk/\");\n/* harmony import */ var _CommentTextArea__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CommentTextArea */ \"P2jM\");\n/* harmony import */ var _canvas_error_boundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/error-boundary */ \"4uX5\");\n/* harmony import */ var _canvas_images_ErrorShip_svg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/images/ErrorShip.svg */ \"1sWr\");\n/* harmony import */ var _canvas_images_ErrorShip_svg__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_canvas_images_ErrorShip_svg__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _canvas_generic_error_page__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @canvas/generic-error-page */ \"qwzJ\");\n/* harmony import */ var _SVGWithTextPlaceholder__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../SVGWithTextPlaceholder */ \"jRG6\");\n/* harmony import */ var _images_ClosedDiscussions_svg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../images/ClosedDiscussions.svg */ \"/yQH\");\n/* harmony import */ var _images_ClosedDiscussions_svg__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_images_ClosedDiscussions_svg__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var _canvas_loading_indicator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @canvas/loading-indicator */ \"7hyl\");\n/* harmony import */ var _instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @instructure/ui-alerts */ \"spba\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _instructure_ui_flex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @instructure/ui-flex */ \"N46v\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var _Context__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../Context */ \"N28T\");\n/* harmony import */ var _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Queries */ \"JZ9k\");\n/* harmony import */ var _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Submission */ \"uqZB\");\n/* harmony import */ var react_apollo__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! react-apollo */ \"Uuew\");\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_8__[\"useScope\"])('assignments_2');\nfunction CommentsTrayBody(props) {\n  const [isFetchingMoreComments, setIsFetchingMoreComments] = Object(react__WEBPACK_IMPORTED_MODULE_14__[\"useState\"])(false);\n  const queryVariables = {\n    submissionId: props.submission.id,\n    submissionAttempt: props.submission.attempt\n  };\n  const {\n    loading,\n    error,\n    data,\n    fetchMore\n  } = Object(react_apollo__WEBPACK_IMPORTED_MODULE_18__[\"useQuery\"])(_canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_16__[\"SUBMISSION_COMMENT_QUERY\"], {\n    variables: queryVariables\n  });\n\n  const loadMoreComments = async () => {\n    setIsFetchingMoreComments(true);\n    await fetchMore({\n      variables: {\n        cursor: data.submissionComments.commentsConnection.pageInfo.startCursor,\n        ...queryVariables\n      },\n      updateQuery: (previousResult, {\n        fetchMoreResult\n      }) => {\n        const newNodes = fetchMoreResult.submissionComments.commentsConnection.nodes;\n        const newPageInfo = fetchMoreResult.submissionComments.commentsConnection.pageInfo;\n        const results = JSON.parse(JSON.stringify(previousResult));\n        results.submissionComments.commentsConnection.pageInfo = newPageInfo;\n\n        if (newNodes.length) {\n          results.submissionComments.commentsConnection.nodes.push(...newNodes);\n        }\n\n        return results;\n      }\n    });\n    setIsFetchingMoreComments(false);\n  };\n\n  const {\n    allowChangesToSubmission\n  } = Object(react__WEBPACK_IMPORTED_MODULE_14__[\"useContext\"])(_Context__WEBPACK_IMPORTED_MODULE_15__[\"default\"]);\n  const gradeAsGroup = props.assignment.groupCategoryId && !props.assignment.gradeGroupStudentsIndividually;\n  if (loading) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_canvas_loading_indicator__WEBPACK_IMPORTED_MODULE_9__[\"default\"], null);\n\n  if (error) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_canvas_generic_error_page__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n      imageUrl: _canvas_images_ErrorShip_svg__WEBPACK_IMPORTED_MODULE_4___default.a,\n      errorSubject: \"Assignments 2 Student submission comments query error\",\n      errorCategory: \"Assignments 2 Student Error Page\"\n    });\n  }\n\n  const comments = data.submissionComments.commentsConnection.nodes;\n  const hiddenCommentsMessage = I18n.t('You may not see all comments for this assignment until grades are posted.');\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_canvas_error_boundary__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n    errorComponent: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_canvas_generic_error_page__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n      imageUrl: _canvas_images_ErrorShip_svg__WEBPACK_IMPORTED_MODULE_4___default.a,\n      errorCategory: \"Assignments 2 Student Comment Error Page\"\n    })\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_12__[\"Flex\"], {\n    as: \"div\",\n    direction: \"column\",\n    height: \"100%\",\n    \"data-testid\": \"comments-container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_12__[\"Flex\"].Item, {\n    grow: true\n  }, props.submission.gradeHidden && comments.length === 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_SVGWithTextPlaceholder__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n    text: hiddenCommentsMessage,\n    url: _images_ClosedDiscussions_svg__WEBPACK_IMPORTED_MODULE_7___default.a,\n    addMargin: true\n  }), props.submission.gradeHidden && comments.length > 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_10__[\"Alert\"], {\n    variant: \"info\",\n    margin: \"small small x-large\"\n  }, hiddenCommentsMessage), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(\"div\", {\n    className: \"load-more-comments-button-container\"\n  }, isFetchingMoreComments && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_canvas_loading_indicator__WEBPACK_IMPORTED_MODULE_9__[\"default\"], null), data.submissionComments.commentsConnection.pageInfo.hasPreviousPage && !isFetchingMoreComments && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_11__[\"Button\"], {\n    color: \"primary\",\n    onClick: loadMoreComments\n  }, I18n.t('Load Previous Comments'))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_CommentContent__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n    comments: comments,\n    submission: props.submission\n  })), allowChangesToSubmission && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_12__[\"Flex\"], {\n    as: \"div\",\n    direction: \"column\"\n  }, gradeAsGroup && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_12__[\"Flex\"].Item, {\n    padding: \"x-small medium\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_13__[\"Text\"], {\n    as: \"div\"\n  }, I18n.t('All comments are sent to the whole group.'))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_12__[\"Flex\"].Item, {\n    padding: \"x-small medium\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_14___default.a.createElement(_CommentTextArea__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n    assignment: props.assignment,\n    submission: props.submission\n  })))));\n}\nCommentsTrayBody.propTypes = {\n  assignment: _canvas_assignments_graphql_student_Assignment__WEBPACK_IMPORTED_MODULE_0__[\"Assignment\"].shape.isRequired,\n  submission: _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_17__[\"Submission\"].shape.isRequired\n};\n\n//# sourceURL=webpack:///./ui/features/assignments_show_student/react/components/CommentsTray/CommentsTrayBody.js?");

/***/ }),

/***/ "P2jM":
/*!***********************************************************************************************!*\
  !*** ./ui/features/assignments_show_student/react/components/CommentsTray/CommentTextArea.js ***!
  \***********************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CommentTextArea; });\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var _instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @instructure/ui-icons */ \"oMAr\");\n/* harmony import */ var react_apollo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-apollo */ \"Uuew\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-a11y-content */ \"9+/z\");\n/* harmony import */ var _instructure_ui_text_area__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-text-area */ \"SLJK\");\n/* harmony import */ var _instructure_canvas_media__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/canvas-media */ \"JobW\");\n/* harmony import */ var _canvas_alerts_react_AlertManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @canvas/alerts/react/AlertManager */ \"5ynn\");\n/* harmony import */ var _canvas_assignments_graphql_student_Assignment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Assignment */ \"yXnT\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _canvas_util_closedCaptionLanguages__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @canvas/util/closedCaptionLanguages */ \"stQK\");\n/* harmony import */ var _canvas_assignments_graphql_student_Mutations__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Mutations */ \"QSeP\");\n/* harmony import */ var _canvas_mime_react_mimeClassIconHelper__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @canvas/mime/react/mimeClassIconHelper */ \"mRBd\");\n/* harmony import */ var _FileList__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../FileList */ \"vUjU\");\n/* harmony import */ var _canvas_loading_indicator__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @canvas/loading-indicator */ \"7hyl\");\n/* harmony import */ var _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Queries */ \"JZ9k\");\n/* harmony import */ var _canvas_upload_file__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @canvas/upload-file */ \"EyBU\");\n/* harmony import */ var _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Submission */ \"uqZB\");\n/* harmony import */ var _helpers_UploadMediaTranslations__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../helpers/UploadMediaTranslations */ \"2tQE\");\n/* harmony import */ var _canvas_emoji__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @canvas/emoji */ \"Dj2d\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_0__[\"useScope\"])('assignments_2');\nconst languages = Object.keys(_canvas_util_closedCaptionLanguages__WEBPACK_IMPORTED_MODULE_10__[\"default\"]).map(key => {\n  return {\n    id: key,\n    label: _canvas_util_closedCaptionLanguages__WEBPACK_IMPORTED_MODULE_10__[\"default\"][key]\n  };\n});\nclass CommentTextArea extends react__WEBPACK_IMPORTED_MODULE_3__[\"Component\"] {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      commentText: '',\n      currentFiles: [],\n      hasError: false,\n      mediaModalOpen: false,\n      mediaObject: null,\n      uploadingComments: false\n    };\n\n    this.updateSubmissionCommentCache = (cache, result) => {\n      if (result.data.createSubmissionComment.errors) {\n        return;\n      }\n\n      const {\n        submissionComments\n      } = JSON.parse(JSON.stringify(cache.readQuery(this.queryVariables())));\n      submissionComments.commentsConnection.nodes = submissionComments.commentsConnection.nodes.concat([result.data.createSubmissionComment.submissionComment]);\n      cache.writeQuery({ ...this.queryVariables(),\n        data: {\n          submissionComments\n        }\n      });\n    };\n\n    this.onFileSelected = event => {\n      let currIndex = this.state.currentFiles.length ? this.state.currentFiles[this.state.currentFiles.length - 1].id : 0;\n      const selectedFiles = [...event.currentTarget.files];\n      selectedFiles.forEach(file => {\n        file.id = ++currIndex;\n      });\n      this.setState(prevState => ({\n        currentFiles: [...prevState.currentFiles, ...selectedFiles]\n      }));\n    };\n\n    this.onMediaModalDismiss = (err, mediaObject) => {\n      if (!err && !mediaObject) {\n        this.setState({\n          mediaModalOpen: false\n        });\n      } else if (err) {\n        // TODO handle error\n        throw new Error(err);\n      } else {\n        mediaObject.type = 'video/mp4';\n        mediaObject.name = mediaObject.media_object.title;\n        let currIndex = this.state.currentFiles.length ? this.state.currentFiles[this.state.currentFiles.length - 1].id : 0;\n        mediaObject.id = ++currIndex;\n        this.setState(prevState => ({\n          mediaModalOpen: false,\n          mediaObject,\n          currentFiles: [...prevState.currentFiles, mediaObject]\n        }));\n      }\n    };\n\n    this.onSendComment = createSubmissionComment => {\n      this.setState({\n        hasError: false,\n        uploadingComments: true\n      }, async () => {\n        const mediaObject = this.state.mediaObject || {\n          media_object: {\n            media_id: null,\n            media_type: null\n          }\n        };\n        let attachmentIds = [];\n        const filesWithoutMediaObject = this.state.currentFiles.filter(file => file !== this.state.mediaObject);\n\n        if (filesWithoutMediaObject.length) {\n          try {\n            const attachments = await Object(_canvas_upload_file__WEBPACK_IMPORTED_MODULE_16__[\"submissionCommentAttachmentsUpload\"])(filesWithoutMediaObject, this.props.assignment.env.courseId, this.props.assignment._id);\n            attachmentIds = attachments.map(attachment => attachment.id);\n          } catch (err) {\n            this.setState({\n              hasError: true,\n              uploadingComments: false\n            });\n            this.context.setOnFailure(I18n.t('Error sending submission comment'));\n            return;\n          }\n        }\n\n        await createSubmissionComment({\n          variables: {\n            id: this.props.submission.id,\n            submissionAttempt: this.props.submission.attempt,\n            comment: this.state.commentText,\n            fileIds: attachmentIds,\n            mediaObjectId: mediaObject.media_object.media_id,\n            mediaObjectType: mediaObject.media_object.media_type\n          }\n        });\n        this.setState({\n          commentText: '',\n          mediaObject: null,\n          currentFiles: [],\n          uploadingComments: false\n        }, () => {\n          if (this._commentTextBox) {\n            this._commentTextBox.focus();\n          }\n        });\n      });\n    };\n\n    this.onTextChange = e => {\n      this.setState({\n        commentText: e.target.value\n      });\n    };\n\n    this.insertEmoji = emoji => {\n      this.setState(state => {\n        return {\n          commentText: state.commentText + emoji.native\n        };\n      }, () => {\n        if (this._commentTextBox) {\n          this._commentTextBox.focus();\n        }\n      });\n    };\n\n    this.handleRemoveFile = refsMap => e => {\n      e.preventDefault();\n      const refs = {};\n      Object.entries(refsMap).forEach(([key, value]) => refs[key] = value);\n      const fileId = parseInt(e.currentTarget.id, 10);\n      const fileIndex = this.state.currentFiles.findIndex(file => file.id === fileId);\n      this.setState(prevState => ({\n        currentFiles: prevState.currentFiles.filter((_, i) => i !== fileIndex)\n      }), () => {\n        if (this.state.currentFiles.length === 0) {\n          this.attachmentFileButton.focus();\n        } else if (fileIndex === 0) {\n          refs[this.state.currentFiles[fileIndex].id].focus();\n        } else {\n          refs[this.state.currentFiles[fileIndex - 1].id].focus();\n        }\n      });\n    };\n\n    this.handleMediaUpload = (error, uploadData, createSubmissionComment) => {\n      if (error) {\n        var _error$file;\n\n        const errorMessage = ((_error$file = error.file) === null || _error$file === void 0 ? void 0 : _error$file.size) > error.maxFileSize * 1024 * 1024 ? I18n.t('File size exceeds the maximum of %{max} MB', {\n          max: error.maxFileSize\n        }) : _helpers_UploadMediaTranslations__WEBPACK_IMPORTED_MODULE_18__[\"UploadMediaStrings\"].UPLOADING_ERROR;\n        this.context.setOnFailure(errorMessage);\n      } else {\n        this.setState({\n          mediaObject: uploadData.mediaObject\n        }, () => {\n          this.onSendComment(createSubmissionComment);\n        });\n      }\n    };\n  }\n\n  queryVariables() {\n    return {\n      query: _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_15__[\"SUBMISSION_COMMENT_QUERY\"],\n      variables: {\n        submissionId: this.props.submission.id,\n        submissionAttempt: this.props.submission.attempt\n      }\n    };\n  }\n\n  optimisticResponse() {\n    return {\n      createSubmissionComment: {\n        errors: null,\n        submissionComment: {\n          _id: 'pending',\n          attachments: [],\n          comment: this.state.commentText,\n          read: true,\n          updatedAt: new Date().toISOString(),\n          author: {\n            avatarUrl: this.props.assignment.env.currentUser.avatar_image_url,\n            shortName: this.props.assignment.env.currentUser.display_name,\n            __typename: 'User'\n          },\n          mediaObject: null,\n          // When we handle upload of media comments we will handle this\n          __typename: 'SubmissionComment'\n        },\n        __typename: 'CreateSubmissionCommentPayload'\n      }\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(react_apollo__WEBPACK_IMPORTED_MODULE_2__[\"Mutation\"], {\n      onCompleted: result => result.createSubmissionComment.errors ? this.context.setOnFailure(I18n.t('Error sending submission comment')) : this.context.setOnSuccess(I18n.t('Submission comment sent')),\n      onError: () => this.context.setOnFailure(I18n.t('Error sending submission comment')),\n      optimisticResponse: this.optimisticResponse(),\n      update: this.updateSubmissionCommentCache,\n      mutation: _canvas_assignments_graphql_student_Mutations__WEBPACK_IMPORTED_MODULE_11__[\"CREATE_SUBMISSION_COMMENT\"]\n    }, createSubmissionComment => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"div\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"div\", {\n      id: \"textarea-emoji-container\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text_area__WEBPACK_IMPORTED_MODULE_5__[\"TextArea\"], {\n      label: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_4__[\"ScreenReaderContent\"], null, I18n.t('Comment input box')),\n      onChange: this.onTextChange,\n      placeholder: I18n.t('Submit a Comment'),\n      ref: el => {\n        this._commentTextBox = el;\n      },\n      value: this.state.commentText\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"span\", {\n      className: \"emoji-picker-container\"\n    }, !this.state.uploadingComments && !!ENV.EMOJIS_ENABLED && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_canvas_emoji__WEBPACK_IMPORTED_MODULE_19__[\"EmojiPicker\"], {\n      insertEmoji: this.insertEmoji\n    }))), this.state.uploadingComments && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_canvas_loading_indicator__WEBPACK_IMPORTED_MODULE_14__[\"default\"], null), this.state.currentFiles.length !== 0 && !this.state.uploadingComments && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"div\", {\n      \"data-testid\": \"assignments_2_comment_attachment\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_FileList__WEBPACK_IMPORTED_MODULE_13__[\"default\"], {\n      files: this.state.currentFiles,\n      removeFileHandler: this.handleRemoveFile,\n      canRemove: true\n    })), !this.state.uploadingComments && !this.state.hasError && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"div\", {\n      className: \"textarea-action-button-container\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"span\", {\n      className: \"emoji-quick-picker-container\"\n    }, !!ENV.EMOJIS_ENABLED && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_canvas_emoji__WEBPACK_IMPORTED_MODULE_19__[\"EmojiQuickPicker\"], {\n      insertEmoji: this.insertEmoji\n    })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"span\", {\n      className: \"textarea-action-buttons\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"input\", {\n      id: \"attachmentFile\",\n      ref: element => {\n        this.fileInput = element;\n      },\n      multiple: true,\n      onChange: this.onFileSelected,\n      style: {\n        display: 'none'\n      },\n      type: \"file\"\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__[\"IconButton\"], {\n      id: \"attachmentFileButton\",\n      renderIcon: _canvas_mime_react_mimeClassIconHelper__WEBPACK_IMPORTED_MODULE_12__[\"DEFAULT_ICON\"],\n      margin: \"0 x-small 0 0\",\n      onClick: () => {\n        this.fileInput.click();\n      },\n      ref: element => {\n        this.attachmentFileButton = element;\n      },\n      size: \"small\",\n      screenReaderLabel: I18n.t('Attach a File'),\n      withBackground: false,\n      withBorder: false\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__[\"IconButton\"], {\n      id: \"mediaCommentButton\",\n      onClick: () => this.setState({\n        mediaModalOpen: true\n      }),\n      renderIcon: _instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconAttachMediaLine\"],\n      margin: \"0 x-small 0 0\",\n      size: \"small\",\n      disabled: this.state.mediaObject,\n      withBackground: false,\n      withBorder: false,\n      screenReaderLabel: I18n.t('Record Audio/Video')\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_canvas_media__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n      contextId: this.props.assignment.env.courseId,\n      contextType: \"course\",\n      languages: languages,\n      liveRegion: () => document.getElementById('flash_screenreader_holder'),\n      onDismiss: this.onMediaModalDismiss,\n      onUploadComplete: (error, data) => {\n        this.handleMediaUpload(error, data, createSubmissionComment);\n      },\n      open: this.state.mediaModalOpen,\n      rcsConfig: {\n        contextId: this.props.assignment.env.courseId,\n        contextType: 'course'\n      },\n      tabs: {\n        embed: false,\n        record: true,\n        upload: true\n      },\n      uploadMediaTranslations: {\n        UploadMediaStrings: _helpers_UploadMediaTranslations__WEBPACK_IMPORTED_MODULE_18__[\"UploadMediaStrings\"],\n        MediaCaptureStrings: _helpers_UploadMediaTranslations__WEBPACK_IMPORTED_MODULE_18__[\"MediaCaptureStrings\"]\n      },\n      disableSubmitWhileUploading: true\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__[\"Button\"], {\n      disabled: this.state.commentText.length === 0 && this.state.currentFiles.length === 0,\n      onClick: () => this.onSendComment(createSubmissionComment)\n    }, I18n.t('Send Comment'))))));\n  }\n\n}\nCommentTextArea.propTypes = {\n  assignment: _canvas_assignments_graphql_student_Assignment__WEBPACK_IMPORTED_MODULE_8__[\"Assignment\"].shape,\n  submission: _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_17__[\"Submission\"].shape\n};\nCommentTextArea.contextType = _canvas_alerts_react_AlertManager__WEBPACK_IMPORTED_MODULE_7__[\"AlertManagerContext\"];\n\n//# sourceURL=webpack:///./ui/features/assignments_show_student/react/components/CommentsTray/CommentTextArea.js?");

/***/ }),

/***/ "mRBd":
/*!*****************************************************!*\
  !*** ./ui/shared/mime/react/mimeClassIconHelper.js ***!
  \*****************************************************/
/*! exports provided: DEFAULT_ICON, ICON_TYPES, getIconByType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_ICON\", function() { return DEFAULT_ICON; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ICON_TYPES\", function() { return ICON_TYPES; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getIconByType\", function() { return getIconByType; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @instructure/ui-icons */ \"oMAr\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nconst DEFAULT_ICON = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconPaperclipLine\"], null);\nconst ICON_TYPES = {\n  audio: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconAttachMediaLine\"], null),\n  code: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconCodeLine\"], null),\n  doc: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconDocumentLine\"], null),\n  file: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconPaperclipLine\"], null),\n  flash: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconPaperclipLine\"], null),\n  folder: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconFolderLine\"], null),\n  'folder-locked': /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconFolderLockedLine\"], null),\n  html: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconCodeLine\"], null),\n  image: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconImageLine\"], null),\n  pdf: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconPdfLine\"], null),\n  ppt: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconMsPptLine\"], null),\n  text: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconDocumentLine\"], null),\n  video: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconAttachMediaLine\"], null),\n  xls: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconMsExcelLine\"], null),\n  zip: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_1__[\"IconZippedLine\"], null)\n};\nfunction getIconByType(attachment_type) {\n  return ICON_TYPES[attachment_type] || DEFAULT_ICON;\n}\n\n//# sourceURL=webpack:///./ui/shared/mime/react/mimeClassIconHelper.js?");

/***/ }),

/***/ "vUjU":
/*!****************************************************************!*\
  !*** ./ui/features/assignments_show_student/react/FileList.js ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _canvas_mime_react_mimeClassIconHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/mime/react/mimeClassIconHelper */ \"mRBd\");\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var _canvas_mime_mimeClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @canvas/mime/mimeClass */ \"scx4\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _instructure_ui_flex__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-flex */ \"N46v\");\n/* harmony import */ var _instructure_ui_icons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-icons */ \"oMAr\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_list__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @instructure/ui-list */ \"dbzd\");\n/* harmony import */ var _instructure_ui_link__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @instructure/ui-link */ \"dlTp\");\n/* harmony import */ var _instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @instructure/ui-a11y-content */ \"9+/z\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_1__[\"useScope\"])('assignments_2');\n\nconst getIcon = file => {\n  if (Object(_canvas_mime_mimeClass__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(file.type) === 'image') {\n    const fileURL = window.URL.createObjectURL(file);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(\"img\", {\n      alt: I18n.t('%{filename} preview', {\n        filename: file.name\n      }),\n      height: \"15\",\n      src: fileURL,\n      width: \"15\"\n    });\n  }\n\n  return Object(_canvas_mime_react_mimeClassIconHelper__WEBPACK_IMPORTED_MODULE_0__[\"getIconByType\"])(Object(_canvas_mime_mimeClass__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(file.type));\n};\n\nconst FileList = props => {\n  const {\n    canRemove,\n    files,\n    removeFileHandler\n  } = props;\n  const refsMap = {};\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_9__[\"List\"], {\n    variant: \"unstyled\",\n    delimiter: \"solid\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_9__[\"List\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__[\"Text\"], {\n    size: \"x-small\",\n    weight: \"bold\"\n  }, I18n.t('Attached'))), files.map(file => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_9__[\"List\"].Item, {\n    key: file.id\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_6__[\"Flex\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_6__[\"Flex\"].Item, {\n    size: \"40px\",\n    padding: \"x-small small\"\n  }, getIcon(file)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_6__[\"Flex\"].Item, {\n    grow: true,\n    shrink: true\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__[\"Text\"], {\n    size: \"x-small\"\n  }, file.name)), file.embedded_iframe_url && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_6__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_link__WEBPACK_IMPORTED_MODULE_10__[\"Link\"], {\n    href: file.embedded_iframe_url,\n    target: \"_blank\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(\"span\", {\n    \"aria-hidden\": true,\n    title: I18n.t('Preview')\n  }, I18n.t('Preview')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_11__[\"ScreenReaderContent\"], null, I18n.t('Preview %{filename}', {\n    filename: file.name\n  })))), canRemove && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_6__[\"Flex\"].Item, {\n    padding: \"0 small 0 x-small\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_5__[\"IconButton\"], {\n    renderIcon: _instructure_ui_icons__WEBPACK_IMPORTED_MODULE_7__[\"IconTrashLine\"],\n    id: file.id,\n    onClick: removeFileHandler(refsMap),\n    ref: element => {\n      refsMap[file.id] = element;\n    },\n    size: \"small\",\n    screenReaderLabel: I18n.t('Remove %{filename}', {\n      filename: file.name\n    }),\n    withBackground: false,\n    withBorder: false\n  }))))));\n};\n\nFileList.propTypes = {\n  canRemove: prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.bool.isRequired,\n  files: prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.shape({\n    id: prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.number.isRequired,\n    name: prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.string.isRequired,\n    type: prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.string.isRequired\n  })).isRequired,\n  removeFileHandler: prop_types__WEBPACK_IMPORTED_MODULE_3___default.a.func\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (FileList);\n\n//# sourceURL=webpack:///./ui/features/assignments_show_student/react/FileList.js?");

/***/ }),

/***/ "xpk/":
/*!**********************************************************************************************!*\
  !*** ./ui/features/assignments_show_student/react/components/CommentsTray/CommentContent.js ***!
  \**********************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CommentContent; });\n/* harmony import */ var _canvas_alerts_react_AlertManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/alerts/react/AlertManager */ \"5ynn\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _CommentRow__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CommentRow */ \"FOH9\");\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var _canvas_assignments_graphql_student_Mutations__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Mutations */ \"QSeP\");\n/* harmony import */ var _images_NoComments_svg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../images/NoComments.svg */ \"GmmD\");\n/* harmony import */ var _images_NoComments_svg__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_images_NoComments_svg__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _Context__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Context */ \"N28T\");\n/* harmony import */ var _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Submission */ \"uqZB\");\n/* harmony import */ var _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @canvas/assignments/graphql/student/Queries */ \"JZ9k\");\n/* harmony import */ var _canvas_assignments_graphql_student_SubmissionComment__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @canvas/assignments/graphql/student/SubmissionComment */ \"nnA0\");\n/* harmony import */ var _SVGWithTextPlaceholder__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../SVGWithTextPlaceholder */ \"jRG6\");\n/* harmony import */ var react_apollo__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! react-apollo */ \"Uuew\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_3__[\"useScope\"])('assignments_2');\nfunction CommentContent(props) {\n  const {\n    setOnFailure,\n    setOnSuccess\n  } = Object(react__WEBPACK_IMPORTED_MODULE_6__[\"useContext\"])(_canvas_alerts_react_AlertManager__WEBPACK_IMPORTED_MODULE_0__[\"AlertManagerContext\"]);\n  const {\n    isObserver\n  } = Object(react__WEBPACK_IMPORTED_MODULE_6__[\"useContext\"])(_Context__WEBPACK_IMPORTED_MODULE_7__[\"default\"]);\n  const [markCommentsRead, {\n    data,\n    called: mutationCalled,\n    error: mutationError\n  }] = Object(react_apollo__WEBPACK_IMPORTED_MODULE_12__[\"useMutation\"])(_canvas_assignments_graphql_student_Mutations__WEBPACK_IMPORTED_MODULE_4__[\"MARK_SUBMISSION_COMMENT_READ\"], {\n    update(cache, result) {\n      var _result$data, _result$data$markSubm;\n\n      // ValidationError, different then the mutationError\n      if ((_result$data = result.data) !== null && _result$data !== void 0 && (_result$data$markSubm = _result$data.markSubmissionCommentsRead) !== null && _result$data$markSubm !== void 0 && _result$data$markSubm.errors) {\n        return;\n      } // Set the read status for all of the submission comments we just\n      // marked as read. I'm sad apollo isn't smart enough to do this without\n      // us manually having to update the cache.\n\n\n      const ids = result.data.markSubmissionCommentsRead.submissionComments.map(c => c._id);\n      const updatedCommentIDs = new Set(ids);\n      const commentQueryVariables = {\n        query: _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_9__[\"SUBMISSION_COMMENT_QUERY\"],\n        variables: {\n          submissionId: props.submission.id,\n          submissionAttempt: props.submission.attempt\n        }\n      };\n      const {\n        submissionComments\n      } = JSON.parse(JSON.stringify(cache.readQuery(commentQueryVariables)));\n      submissionComments.commentsConnection.nodes.forEach(comment => {\n        if (updatedCommentIDs.has(comment._id)) {\n          comment.read = true;\n        }\n      });\n      cache.writeQuery({ ...commentQueryVariables,\n        data: {\n          submissionComments\n        }\n      }); // Now update the unreadCommentCount. We have to handle the current\n      // submission and submission histories separately as they exist in\n      // different parts in the apollo cache. Try the current submission first\n\n      const submissionQueryVariables = {\n        id: props.submission.id,\n        fragment: _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_8__[\"Submission\"].fragment,\n        fragmentName: 'Submission',\n        variables: {\n          submissionID: props.submission.id\n        }\n      };\n      const cachedCurrentSubmission = cache.readFragment(submissionQueryVariables);\n\n      if (props.submission.attempt === cachedCurrentSubmission.attempt) {\n        const submission = JSON.parse(JSON.stringify(cachedCurrentSubmission));\n        const newUnreadCount = Math.max(0, submission.unreadCommentCount - updatedCommentIDs.size);\n        submission.unreadCommentCount = newUnreadCount;\n        cache.writeFragment({ ...submissionQueryVariables,\n          data: submission\n        });\n      } else {\n        const cachedHistories = cache.readQuery({\n          query: _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_9__[\"SUBMISSION_HISTORIES_QUERY\"],\n          variables: {\n            submissionID: props.submission.id\n          }\n        });\n        const histories = JSON.parse(JSON.stringify(cachedHistories));\n        histories.node.submissionHistoriesConnection.nodes.forEach(history => {\n          if (history.attempt !== props.submission.attempt) {\n            return;\n          }\n\n          const newUnreadCount = Math.max(0, history.unreadCommentCount - updatedCommentIDs.size);\n          history.unreadCommentCount = newUnreadCount;\n        });\n        cache.writeQuery({\n          query: _canvas_assignments_graphql_student_Queries__WEBPACK_IMPORTED_MODULE_9__[\"SUBMISSION_HISTORIES_QUERY\"],\n          variables: {\n            submissionID: props.submission.id\n          },\n          data: histories\n        });\n      }\n    }\n\n  });\n  Object(react__WEBPACK_IMPORTED_MODULE_6__[\"useEffect\"])(() => {\n    const unreadComments = props.comments.filter(c => !c.read);\n\n    if (unreadComments.length > 0 && !isObserver) {\n      const commentIds = props.comments.filter(comment => comment.read === false).map(comment => comment._id);\n      const timer = setTimeout(() => {\n        markCommentsRead({\n          variables: {\n            commentIds,\n            submissionId: props.submission.id\n          }\n        });\n      }, 1000);\n      return () => clearTimeout(timer);\n    }\n  }, [isObserver, markCommentsRead, props.comments, props.submission]);\n  Object(react__WEBPACK_IMPORTED_MODULE_6__[\"useEffect\"])(() => {\n    var _data$markSubmissionC, _data$markSubmissionC2;\n\n    if (mutationCalled && !mutationError && !(data !== null && data !== void 0 && (_data$markSubmissionC = data.markSubmissionCommentsRead) !== null && _data$markSubmissionC !== void 0 && _data$markSubmissionC.errors)) {\n      setOnSuccess(I18n.t('All submission comments have been marked as read'));\n    } else if (mutationError || data !== null && data !== void 0 && (_data$markSubmissionC2 = data.markSubmissionCommentsRead) !== null && _data$markSubmissionC2 !== void 0 && _data$markSubmissionC2.errors) {\n      setOnFailure(I18n.t('There was a problem marking submission comments as read'));\n    }\n  }, [data, mutationCalled, mutationError, setOnFailure, setOnSuccess]);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment, null, !props.submission.gradeHidden && !props.comments.length && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_SVGWithTextPlaceholder__WEBPACK_IMPORTED_MODULE_11__[\"default\"], {\n    text: I18n.t(\"This is where you can leave a comment and view your instructor's feedback.\"),\n    url: _images_NoComments_svg__WEBPACK_IMPORTED_MODULE_5___default.a\n  }), props.comments.sort((a, b) => new Date(a.updatedAt) - new Date(b.updatedAt)).map(comment => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_13__[\"View\"], {\n    as: \"div\",\n    key: comment._id,\n    padding: \"0 medium 0 x-small\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_CommentRow__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n    comment: comment\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(\"hr\", {\n    style: {\n      margin: '1rem 1.5rem'\n    }\n  }))));\n}\nCommentContent.propTypes = {\n  comments: Object(prop_types__WEBPACK_IMPORTED_MODULE_1__[\"arrayOf\"])(_canvas_assignments_graphql_student_SubmissionComment__WEBPACK_IMPORTED_MODULE_10__[\"SubmissionComment\"].shape).isRequired,\n  submission: _canvas_assignments_graphql_student_Submission__WEBPACK_IMPORTED_MODULE_8__[\"Submission\"].shape.isRequired\n};\n\n//# sourceURL=webpack:///./ui/features/assignments_show_student/react/components/CommentsTray/CommentContent.js?");

/***/ })

}]);