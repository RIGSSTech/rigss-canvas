(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([[3785],{

/***/ "+y7l":
/*!***********************************************************************!*\
  !*** ./ui/shared/lti/jquery/subjects/__tests__/lti.showAlert.test.js ***!
  \***********************************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lti_showAlert__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lti.showAlert */ \"onLg\");\n/* harmony import */ var _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @canvas/rails-flash-notifications */ \"r2Yr\");\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\ndescribe('lti.showAlert handler', () => {\n  let message;\n  let responseMessages;\n  const body = 'Hello world!';\n  beforeEach(() => {\n    responseMessages = {\n      sendBadRequestError: jest.fn(),\n      sendSuccess: jest.fn()\n    };\n  });\n  describe('when body is not present', () => {\n    beforeEach(() => {\n      message = {};\n    });\n    it('sends bad request postMesssage', () => {\n      Object(_lti_showAlert__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        message,\n        responseMessages\n      });\n      expect(responseMessages.sendBadRequestError).toHaveBeenCalledWith(\"Missing required 'body' field\");\n    });\n  });\n  describe('when alertType is not supported', () => {\n    beforeEach(() => {\n      message = {\n        body,\n        alertType: 'bad'\n      };\n    });\n    it('sends bad request postMesssage', () => {\n      Object(_lti_showAlert__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        message,\n        responseMessages\n      });\n      expect(responseMessages.sendBadRequestError).toHaveBeenCalledWith(\"Unsupported value for 'alertType' field\");\n    });\n  });\n  Object.entries({\n    success: 'flashMessageSafe',\n    warning: 'flashWarningSafe',\n    error: 'flashErrorSafe'\n  }).forEach(([alertType, method]) => {\n    // eslint-disable-next-line jest/valid-describe\n    describe(`when alertType is ${alertType}`, () => {\n      beforeEach(() => {\n        message = {\n          body,\n          alertType\n        };\n        jest.spyOn(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"], method);\n      });\n      afterEach(() => {\n        _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"][method].mockRestore();\n      });\n      it('shows message', () => {\n        Object(_lti_showAlert__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n          message,\n          responseMessages\n        });\n        expect(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"][method]).toHaveBeenCalled();\n      });\n      it('sends success postMesssage', () => {\n        Object(_lti_showAlert__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n          message,\n          responseMessages\n        });\n        expect(responseMessages.sendSuccess).toHaveBeenCalled();\n      });\n    });\n  });\n  describe('when title is provided', () => {\n    const title = 'Tool Name';\n    beforeEach(() => {\n      message = {\n        body,\n        title\n      };\n      jest.spyOn(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"], 'flashMessageSafe');\n    });\n    afterEach(() => {\n      _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"].flashMessageSafe.mockRestore();\n    });\n    it('uses title from message', () => {\n      Object(_lti_showAlert__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        message,\n        responseMessages\n      });\n      expect(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"].flashMessageSafe).toHaveBeenCalledWith(expect.stringContaining(title));\n    });\n  });\n  describe('when title is not found', () => {\n    beforeEach(() => {\n      message = {\n        body\n      };\n      jest.spyOn(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"], 'flashMessageSafe');\n    });\n    afterEach(() => {\n      _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"].flashMessageSafe.mockRestore();\n    });\n    it('uses title from message', () => {\n      Object(_lti_showAlert__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        message,\n        responseMessages\n      });\n      expect(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_1__[\"default\"].flashMessageSafe).toHaveBeenCalledWith(expect.stringContaining('External Tool'));\n    });\n  });\n});\n\n//# sourceURL=webpack:///./ui/shared/lti/jquery/subjects/__tests__/lti.showAlert.test.js?");

/***/ }),

/***/ "onLg":
/*!********************************************************!*\
  !*** ./ui/shared/lti/jquery/subjects/lti.showAlert.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return showAlert; });\n/* harmony import */ var _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/rails-flash-notifications */ \"r2Yr\");\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/*\n * Copyright (C) 2018 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_1__[\"useScope\"])('ltiMessages');\nfunction showAlert({\n  message,\n  responseMessages\n}) {\n  if (!message.body) {\n    responseMessages.sendBadRequestError(\"Missing required 'body' field\");\n    return true;\n  }\n\n  const {\n    title,\n    alertType,\n    body\n  } = message;\n  const contents = typeof body === 'string' ? body : JSON.stringify(body);\n  const toolName = title || Object(_canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_0__[\"default\"])('iframe[data-lti-launch]').attr('title') || I18n.t('External Tool');\n  const displayMessage = `${toolName}: ${contents}`;\n\n  switch (alertType || 'success') {\n    case 'success':\n      _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_0__[\"default\"].flashMessageSafe(displayMessage);\n      break;\n\n    case 'warning':\n      _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_0__[\"default\"].flashWarningSafe(displayMessage);\n      break;\n\n    case 'error':\n      _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_0__[\"default\"].flashErrorSafe(displayMessage);\n      break;\n\n    default:\n      responseMessages.sendBadRequestError(\"Unsupported value for 'alertType' field\");\n      return true;\n  }\n\n  responseMessages.sendSuccess();\n  return true;\n}\n\n//# sourceURL=webpack:///./ui/shared/lti/jquery/subjects/lti.showAlert.js?");

/***/ })

}]);