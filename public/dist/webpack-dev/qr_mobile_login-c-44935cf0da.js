(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([["qr_mobile_login"],{

/***/ "08kA":
/*!*************************************************!*\
  !*** ./node_modules/parse-link-header/index.js ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar qs = __webpack_require__(/*! querystring */ \"s4NR\")\n  , url = __webpack_require__(/*! url */ \"CxY0\")\n  , xtend = __webpack_require__(/*! xtend */ \"U6jy\");\n\nfunction hasRel(x) {\n  return x && x.rel;\n}\n\nfunction intoRels (acc, x) {\n  function splitRel (rel) {\n    acc[rel] = xtend(x, { rel: rel });\n  }\n\n  x.rel.split(/\\s+/).forEach(splitRel);\n\n  return acc;\n}\n\nfunction createObjects (acc, p) {\n  // rel=\"next\" => 1: rel 2: next\n  var m = p.match(/\\s*(.+)\\s*=\\s*\"?([^\"]+)\"?/)\n  if (m) acc[m[1]] = m[2];\n  return acc;\n}\n\nfunction parseLink(link) {\n  try {\n    var m         =  link.match(/<?([^>]*)>(.*)/)\n      , linkUrl   =  m[1]\n      , parts     =  m[2].split(';')\n      , parsedUrl =  url.parse(linkUrl)\n      , qry       =  qs.parse(parsedUrl.query);\n\n    parts.shift();\n\n    var info = parts\n      .reduce(createObjects, {});\n    \n    info = xtend(qry, info);\n    info.url = linkUrl;\n    return info;\n  } catch (e) {\n    return null;\n  }\n}\n\nmodule.exports = function (linkHeader) {\n  if (!linkHeader) return null;\n\n  return linkHeader.split(/,\\s*</)\n   .map(parseLink)\n   .filter(hasRel)\n   .reduce(intoRels, {});\n};\n\n\n//# sourceURL=webpack:///./node_modules/parse-link-header/index.js?");

/***/ }),

/***/ "1b+i":
/*!***************************************!*\
  !*** ./packages/js-utils/es/index.js ***!
  \***************************************/
/*! exports provided: getPrefetchedXHR, consumePrefetchedXHR, setPrefetchedXHR, clearPrefetchedXHRs, asAxios, asJson, asText, checkStatus, defaultFetchOptions, filterUselessConsoleMessages */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prefetched_xhrs */ \"etQE\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getPrefetchedXHR\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"getPrefetchedXHR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"consumePrefetchedXHR\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"consumePrefetchedXHR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setPrefetchedXHR\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"setPrefetchedXHR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"clearPrefetchedXHRs\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"clearPrefetchedXHRs\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"asAxios\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"asAxios\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"asJson\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"asJson\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"asText\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"asText\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"checkStatus\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"checkStatus\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"defaultFetchOptions\", function() { return _prefetched_xhrs__WEBPACK_IMPORTED_MODULE_0__[\"defaultFetchOptions\"]; });\n\n/* harmony import */ var _filterUselessConsoleMessages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./filterUselessConsoleMessages */ \"9UY7\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterUselessConsoleMessages\", function() { return _filterUselessConsoleMessages__WEBPACK_IMPORTED_MODULE_1__[\"filterUselessConsoleMessages\"]; });\n\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n//# sourceURL=webpack:///./packages/js-utils/es/index.js?");

/***/ }),

/***/ "9UY7":
/*!**************************************************************!*\
  !*** ./packages/js-utils/es/filterUselessConsoleMessages.js ***!
  \**************************************************************/
/*! exports provided: filterUselessConsoleMessages */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filterUselessConsoleMessages\", function() { return filterUselessConsoleMessages; });\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nconst consoleMessagesToIgnore = {\n  error: [// /Failed prop type/, // uncomment if you want to focus on stuff besides propType warnings\n  'Warning: [Focusable] Exactly one tabbable child is required (0 found).', // This is from @instructure/ui-menu, nothing we can do about it ourselves\n  /Function components cannot be given refs\\. Attempts to access this ref will fail[\\s\\S]*in (CanvasInstUIModal|PopoverTrigger)/, /Warning: \\[themeable\\] A theme registry has already been initialized.*/, // from an old discussions edit page\n  /Error: Not implemented: navigation \\(except hash changes\\)/, // Until INSTUI updates FormPropTypes.message\n  // see https://github.com/instructure/instructure-ui/issues/815\n  'Invalid prop `messages[0].text` of type `object` supplied to'],\n  warn: [// Uncomment the following line if all the react 16.9 deprecations are cluttering up\n  // the console and you want to focus on something else\n  // /Please update the following components/,\n  // The build logs have grown to over 250MB so in an interest of being able to use\n  // the build logs at all we're filtering out these general messages.\n  /is deprecated and will be removed/, // '@instructure/ui-select' itself generates this warning, we assume they will figure it out themselves\n  /is experimental and its API could change significantly in a future release/, 'Warning: [Focusable] Exactly one focusable child is required (0 found).', /in Select \\(created by CanvasSelect\\)/, 'created by DateInput', 'created by Editable', // React 16.9+ generates these deprecation warnings but it doesn't do any good to hear about the ones for instUI. We can't do anything about them in this repo\n  // Put any others we can't control here.\n  /Please update the following components:[ (BaseTransition|Billboard|Button|Checkbox|CloseButton|Dialog|Expandable|FileDrop|Flex|FlexItem|FormFieldGroup|FormFieldLabel|FormFieldLayout|FormFieldMessage|FormFieldMessages|Grid|GridCol|GridRow|Heading|InlineSVG|Mask|ModalBody|ModalFooter|ModalHeader|NumberInput|Portal|Query|Responsive|SVGIcon|ScreenReaderContent|SelectOptionsList|SelectField|SelectMultiple|SelectOptionsList|SelectSingle|Spinner|Tab|Text|TextArea|TextInput|TinyMCE|ToggleDetails|ToggleFacade|Transition|TruncateText|View),?]+$/, // output of Pagination component substitutes the component name for the placeholder %s\n  /Please update the following components: %s,Pagination/ // /is deprecated and will be removed/, // uncomment to remove instui deprecation messages\n  // /Translation for/ // uncomment to remove missing translation messages\n  ]\n};\nfunction filterUselessConsoleMessages(originalConsole = console) {\n  Object.keys(consoleMessagesToIgnore).forEach(key => {\n    const original = originalConsole[key];\n\n    originalConsole[key] = function () {\n      const combinedMsg = Array.prototype.join.call(arguments);\n\n      const shouldIgnore = pattern => combinedMsg[typeof pattern === 'string' ? 'includes' : 'match'](pattern);\n\n      if (consoleMessagesToIgnore[key].some(shouldIgnore)) return;\n      return original.apply(this, arguments);\n    };\n  });\n}\n\n//# sourceURL=webpack:///./packages/js-utils/es/filterUselessConsoleMessages.js?");

/***/ }),

/***/ "9fju":
/*!*****************************************************!*\
  !*** ./ui/features/qr_mobile_login/fromNowFuzzy.js ***!
  \*****************************************************/
/*! exports provided: fromNow */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fromNow\", function() { return fromNow; });\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/*\n * Copyright (C) 2020 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_0__[\"useScope\"])('fromNowFuzzy');\nconst TIME_UNITS = Object.freeze([1000, // msec in a second\n60, // seconds in a minute\n60, // minutes in an hour\n24, // hours in a day\n7 // days in a week\n]);\nconst UNIT_NAMES = Object.freeze(['millisecond', // not used, Intl does not understand it\n'second', 'minute', 'hour', 'day', 'week']);\n\nfunction buildTime(msec) {\n  const negative = msec < 0; // Just because it's never reassigned doesn't mean it's not mutated a lot\n  // eslint-disable-next-line prefer-const\n\n  let result = [negative];\n  let remainder = negative ? -msec : msec;\n  TIME_UNITS.forEach(d => {\n    result.push(Math.floor(remainder % d));\n    remainder /= d;\n  });\n  result.push(Math.floor(remainder));\n  return result;\n}\n\nfunction timeDistance(times, opts) {\n  const {\n    locale,\n    ...intlOpts\n  } = opts;\n\n  if (times.length !== TIME_UNITS.length + 2) {\n    throw new Error('argument must be buildTime array');\n  } // Just because it's never reassigned doesn't mean it's not mutated a lot\n\n  /* eslint-disable prefer-const */\n\n\n  let units = TIME_UNITS.slice().reverse();\n  let unitArray = times.slice().reverse();\n  let unitNames = UNIT_NAMES.slice().reverse();\n  /* eslint-enable prefer-const */\n\n  const negative = unitArray.pop();\n  const rtf = new Intl.RelativeTimeFormat(locale || ENV.LOCALE || navigator.language, {\n    style: 'long',\n    numeric: 'auto',\n    ...intlOpts\n  });\n\n  while (unitArray.length > 1 && unitArray[0] === 0) {\n    unitArray.shift();\n    unitNames.shift();\n    units.shift();\n  } // if only milliseconds are left, just call it \"now\"\n\n\n  if (unitArray.length < 2) return rtf.format(0, 'second'); // otherwise, if only seconds are left, return a friendly value\n\n  if (unitArray.length === 2) {\n    if (unitArray[0] <= 20) return negative ? I18n.t('a few seconds ago') : I18n.t('in a few seconds');\n    return negative ? I18n.t('less than a minute ago') : I18n.t('in less than a minute');\n  } // otherwise round up the biggest unit and use that\n\n\n  const value = Math.round(unitArray[0] + unitArray[1] / units[0]) * (negative ? -1 : 1);\n  return rtf.format(value, unitNames[0]);\n}\n\nfunction fromNow(date, opts = {}) {\n  const now = Date.now();\n  let thence;\n\n  if (date instanceof Date) {\n    thence = date.getTime();\n    if (Number.isNaN(thence)) throw new Error('argument Date is invalid');\n  } else if (typeof date === 'number') {\n    thence = date;\n  } else {\n    throw new Error('argument must be Date object or numeric msec');\n  }\n\n  return timeDistance(buildTime(thence - now), opts);\n}\n\n//# sourceURL=webpack:///./ui/features/qr_mobile_login/fromNowFuzzy.js?");

/***/ }),

/***/ "CqQH":
/*!************************************************************!*\
  !*** ./ui/features/qr_mobile_login/react/QRMobileLogin.js ***!
  \************************************************************/
/*! exports provided: QRMobileLogin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"QRMobileLogin\", function() { return QRMobileLogin; });\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _canvas_alerts_react_FlashAlert__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @canvas/alerts/react/FlashAlert */ \"uloQ\");\n/* harmony import */ var _canvas_do_fetch_api_effect__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/do-fetch-api-effect */ \"Ipg6\");\n/* harmony import */ var _instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-flex */ \"N46v\");\n/* harmony import */ var _instructure_ui_heading__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-heading */ \"nwNI\");\n/* harmony import */ var _instructure_ui_img__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-img */ \"ad5e\");\n/* harmony import */ var _instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-spinner */ \"cPO5\");\n/* harmony import */ var _instructure_ui_modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-modal */ \"7I2A\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/* harmony import */ var _fromNowFuzzy__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../fromNowFuzzy */ \"9fju\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_13__);\n/*\n * Copyright (C) 2020 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_0__[\"useScope\"])('QRMobileLogin');\nconst REFRESH_INTERVAL = 1000 * (9 * 60 + 45); // 9 min 45 sec\n\nconst POLL_INTERVAL = 1000 * 5; // 5 sec\n\nconst QR_CODE_LIFETIME = 1000 * 10 * 60; // 10 minutes\n\nconst DISPLAY_STATE = {\n  canceled: 0,\n  warning: 1,\n  displayed: 2\n};\n\nconst modalLabel = () => I18n.t('Confirm QR code display');\n\nfunction QRMobileLogin({\n  refreshInterval,\n  pollInterval,\n  withWarning\n}) {\n  const [imagePng, setImagePng] = Object(react__WEBPACK_IMPORTED_MODULE_1__[\"useState\"])(null);\n  const [validFor, setValidFor] = Object(react__WEBPACK_IMPORTED_MODULE_1__[\"useState\"])(null);\n  const [display, setDisplay] = Object(react__WEBPACK_IMPORTED_MODULE_1__[\"useState\"])(withWarning ? DISPLAY_STATE.warning : DISPLAY_STATE.displayed);\n\n  function renderQRCode() {\n    let body;\n\n    switch (display) {\n      case DISPLAY_STATE.canceled:\n        body = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_10__[\"Text\"], {\n          size: \"large\"\n        }, I18n.t('QR code display was canceled'));\n        break;\n\n      case DISPLAY_STATE.warning:\n        body = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__[\"Spinner\"], {\n          \"data-testid\": \"qr-code-spinner\",\n          renderTitle: I18n.t('Waiting for confirmation to display QR code')\n        });\n        break;\n\n      case DISPLAY_STATE.displayed:\n        if (imagePng) {\n          body = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(\"span\", {\n            className: \"fs-exclude\"\n          }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_img__WEBPACK_IMPORTED_MODULE_6__[\"Img\"], {\n            alt: I18n.t('QR Code Image'),\n            constrain: \"contain\",\n            \"data-testid\": \"qr-code-image\",\n            src: `data:image/png;base64, ${imagePng}`\n          }));\n        } else {\n          body = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__[\"Spinner\"], {\n            \"data-testid\": \"qr-code-spinner\",\n            renderTitle: I18n.t('Waiting for your QR Code to load')\n          });\n        }\n\n    }\n\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, display !== DISPLAY_STATE.canceled && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_11__[\"View\"], {\n      display: \"block\"\n    }, I18n.t('To log in to your Canvas account when you’re on the go, scan this QR code from any Canvas mobile app.')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_11__[\"View\"], {\n      display: \"block\",\n      textAlign: \"center\",\n      padding: \"small xx-large\"\n    }, body));\n  }\n\n  function onModalProceed() {\n    setDisplay(DISPLAY_STATE.displayed);\n  }\n\n  function onModalCancel() {\n    setDisplay(DISPLAY_STATE.canceled);\n  }\n\n  function startTimedEvents() {\n    let timerId = null;\n    let isFetching = false;\n    let validUntil = null;\n    let refetchAt = null;\n\n    function displayValidFor(expireTime) {\n      if (expireTime) validUntil = expireTime;\n\n      if (validUntil) {\n        const newValidFor = Date.now() < validUntil ? I18n.t('This code expires %{timeFromNow}.', {\n          timeFromNow: Object(_fromNowFuzzy__WEBPACK_IMPORTED_MODULE_12__[\"fromNow\"])(validUntil)\n        }) : I18n.t('This code has expired.');\n        setValidFor(newValidFor);\n      }\n    }\n\n    async function getQRCode() {\n      isFetching = true;\n\n      try {\n        const {\n          json\n        } = await Object(_canvas_do_fetch_api_effect__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n          path: '/canvas/login.png',\n          method: 'POST'\n        });\n        displayValidFor(Date.now() + QR_CODE_LIFETIME);\n        refetchAt = Date.now() + refreshInterval;\n        setImagePng(json.png);\n      } catch (err) {\n        Object(_canvas_alerts_react_FlashAlert__WEBPACK_IMPORTED_MODULE_2__[\"showFlashAlert\"])({\n          message: I18n.t('An error occurred while retrieving your QR Code'),\n          err\n        });\n      } finally {\n        isFetching = false;\n      }\n    }\n\n    function poll() {\n      displayValidFor();\n      if (!isFetching && (!refetchAt || Date.now() > refetchAt)) getQRCode();\n      timerId = setTimeout(poll, pollInterval);\n    }\n\n    if (display === DISPLAY_STATE.displayed) poll();\n    return () => {\n      if (timerId) clearTimeout(timerId);\n    };\n  }\n\n  Object(react__WEBPACK_IMPORTED_MODULE_1__[\"useEffect\"])(startTimedEvents, [display]);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"], {\n    direction: \"column\",\n    justifyItems: \"center\",\n    margin: \"none medium\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, {\n    margin: \"xx-small\",\n    padding: \"xx-small\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_heading__WEBPACK_IMPORTED_MODULE_5__[\"Heading\"], {\n    level: \"h1\"\n  }, I18n.t('QR for Mobile Login'))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_11__[\"View\"], flexViewProps, renderQRCode(), validFor && display === DISPLAY_STATE.displayed && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_10__[\"Text\"], {\n    weight: \"light\",\n    size: \"small\"\n  }, validFor)))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_8__[\"Modal\"], {\n    size: \"small\",\n    open: display === DISPLAY_STATE.warning,\n    onDismiss: onModalCancel,\n    shouldCloseOnDocumentClick: false,\n    label: modalLabel()\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_8__[\"Modal\"].Header, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__[\"CloseButton\"], {\n    \"data-testid\": \"qr-header-close-button\",\n    placement: \"end\",\n    offset: \"medium\",\n    onClick: onModalCancel,\n    screenReaderLabel: I18n.t('Cancel')\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_heading__WEBPACK_IMPORTED_MODULE_5__[\"Heading\"], null, modalLabel())), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_8__[\"Modal\"].Body, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_11__[\"View\"], {\n    as: \"div\",\n    margin: \"medium large\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_10__[\"Text\"], {\n    as: \"div\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(\"p\", null, I18n.t('Sharing a QR code can give others immediate access to your account through the %{canvas} mobile applications.', {\n    canvas: 'Canvas'\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(\"p\", null, I18n.t('Please make sure no one is able to capture the image on your screen from your surroundings or from a screen sharing service.')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(\"p\", null, I18n.t('Click \"Proceed\" to continue.')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(\"p\", null, I18n.t('Click \"Cancel\" if you donʼt want the code displayed.'))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_8__[\"Modal\"].Footer, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__[\"Button\"], {\n    \"data-testid\": \"qr-cancel-button\",\n    margin: \"none x-small\",\n    onClick: onModalCancel\n  }, I18n.t('Cancel')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_9__[\"Button\"], {\n    \"data-testid\": \"qr-proceed-button\",\n    color: \"primary\",\n    margin: \"none x-small\",\n    onClick: onModalProceed\n  }, I18n.t('Proceed')))));\n}\nconst flexViewProps = {\n  borderColor: 'primary',\n  borderWidth: 'small',\n  borderRadius: 'medium',\n  padding: 'medium',\n  margin: 'medium small',\n  maxWidth: '30rem',\n  as: 'div'\n};\nQRMobileLogin.propTypes = {\n  refreshInterval: prop_types__WEBPACK_IMPORTED_MODULE_13__[\"number\"],\n  pollInterval: prop_types__WEBPACK_IMPORTED_MODULE_13__[\"number\"],\n  withWarning: prop_types__WEBPACK_IMPORTED_MODULE_13__[\"bool\"]\n};\nQRMobileLogin.defaultProps = {\n  refreshInterval: REFRESH_INTERVAL,\n  pollInterval: POLL_INTERVAL,\n  withWarning: false\n};\n\n//# sourceURL=webpack:///./ui/features/qr_mobile_login/react/QRMobileLogin.js?");

/***/ }),

/***/ "Ipg6":
/*!************************************************!*\
  !*** ./ui/shared/do-fetch-api-effect/index.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return doFetchApi; });\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ \"ouhR\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _instructure_get_cookie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @instructure/get-cookie */ \"FOCd\");\n/* harmony import */ var parse_link_header__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! parse-link-header */ \"08kA\");\n/* harmony import */ var parse_link_header__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(parse_link_header__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _instructure_js_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/js-utils */ \"1b+i\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nfunction constructRelativeUrl({\n  path,\n  params\n}) {\n  const queryString = jquery__WEBPACK_IMPORTED_MODULE_0___default.a.param(params);\n  if (!queryString.length) return path;\n  return `${path}?${queryString}`;\n} // https://fetch.spec.whatwg.org/#requestinit\n\n\n// NOTE: we do NOT deep-merge customFetchOptions.headers, they should be passed\n// in the headers arg instead.\nasync function doFetchApi({\n  path,\n  method = 'GET',\n  headers = {},\n  params = {},\n  body,\n  fetchOpts = {}\n}) {\n  const finalFetchOptions = { ..._instructure_js_utils__WEBPACK_IMPORTED_MODULE_3__[\"defaultFetchOptions\"]\n  };\n  finalFetchOptions.headers['X-CSRF-Token'] = Object(_instructure_get_cookie__WEBPACK_IMPORTED_MODULE_1__[\"default\"])('_csrf_token');\n\n  if (body && typeof body !== 'string') {\n    body = JSON.stringify(body);\n    finalFetchOptions.headers['Content-Type'] = 'application/json';\n  }\n\n  Object.assign(finalFetchOptions.headers, headers);\n  Object.assign(finalFetchOptions, fetchOpts);\n  const url = constructRelativeUrl({\n    path,\n    params\n  });\n  const response = await fetch(url, {\n    body,\n    method,\n    ...finalFetchOptions\n  });\n\n  if (!response.ok) {\n    const err = new Error(`doFetchApi received a bad response: ${response.status} ${response.statusText}`);\n    Object.assign(err, {\n      response\n    }); // in case anyone wants to check it for something\n\n    throw err;\n  }\n\n  const linkHeader = response.headers.get('Link');\n  const link = linkHeader && parse_link_header__WEBPACK_IMPORTED_MODULE_2___default()(linkHeader) || undefined;\n  const text = await response.text();\n  const json = text.length > 0 ? JSON.parse(text) : undefined;\n  return {\n    json,\n    response,\n    link\n  };\n}\n\n//# sourceURL=webpack:///./ui/shared/do-fetch-api-effect/index.ts?");

/***/ }),

/***/ "OMO5":
/*!**********************************************!*\
  !*** ./ui/features/qr_mobile_login/index.js ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-dom */ \"i8i4\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _instructure_ready__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @instructure/ready */ \"3lLS\");\n/* harmony import */ var _instructure_ready__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_instructure_ready__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _react_QRMobileLogin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./react/QRMobileLogin */ \"CqQH\");\n/*\n * Copyright (C) 2020 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n_instructure_ready__WEBPACK_IMPORTED_MODULE_2___default()(() => {\n  let container;\n  container = document.createElement('div');\n  container.setAttribute('id', 'qr_login_container');\n  const content = document.querySelector('#content');\n  content.appendChild(container);\n  container = document.querySelector('#qr_login_container');\n\n  if (container) {\n    react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_react_QRMobileLogin__WEBPACK_IMPORTED_MODULE_3__[\"QRMobileLogin\"], {\n      withWarning: true\n    }), container);\n  }\n});\n\n//# sourceURL=webpack:///./ui/features/qr_mobile_login/index.js?");

/***/ }),

/***/ "U6jy":
/*!*****************************************!*\
  !*** ./node_modules/xtend/immutable.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n\n\n//# sourceURL=webpack:///./node_modules/xtend/immutable.js?");

/***/ }),

/***/ "etQE":
/*!*************************************************!*\
  !*** ./packages/js-utils/es/prefetched_xhrs.js ***!
  \*************************************************/
/*! exports provided: getPrefetchedXHR, consumePrefetchedXHR, setPrefetchedXHR, clearPrefetchedXHRs, asAxios, asJson, asText, checkStatus, defaultFetchOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPrefetchedXHR\", function() { return getPrefetchedXHR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"consumePrefetchedXHR\", function() { return consumePrefetchedXHR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setPrefetchedXHR\", function() { return setPrefetchedXHR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearPrefetchedXHRs\", function() { return clearPrefetchedXHRs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"asAxios\", function() { return asAxios; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"asJson\", function() { return asJson; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"asText\", function() { return asText; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"checkStatus\", function() { return checkStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultFetchOptions\", function() { return defaultFetchOptions; });\n/* harmony import */ var _instructure_get_cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @instructure/get-cookie */ \"FOCd\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n // These are helpful methods you can use along side the ruby ApplicationHelper::prefetch_xhr helper method in canvas\n\n/**\n * Retrieve the fetch response promise assigned to the given id. This will\n * return `undefined` if there are no prefetched requests or there is no\n * request assigned to the given id. When a request is assigned to the given\n * id, it will remain stored for subsequent retrievals, if needed.\n *\n * @param {String} id\n * @returns {Promise<Response>} fetchResponsePromise\n */\n\nfunction getPrefetchedXHR(id) {\n  return window.prefetched_xhrs && window.prefetched_xhrs[id];\n}\n/**\n * Retrieve the fetch response promise assigned to the given id. This will\n * return `undefined` if there are no prefetched requests or there is no\n * request assigned to the given id. When a request is assigned to the given\n * id, it will be removed from request storage. This is important for requests\n * which are expected to return fresh results upon each request.\n *\n * @param {String} id\n * @returns {Promise<Response>} fetchResponsePromise\n */\n\nfunction consumePrefetchedXHR(id) {\n  if (window.prefetched_xhrs) {\n    const value = window.prefetched_xhrs[id];\n    delete window.prefetched_xhrs[id];\n    return value;\n  }\n\n  return undefined;\n}\n/**\n * Store a fetch response promise assigned to the given id. This function is\n * intended for specs so that they do not need awareness of the implementation\n * details for how prefetched requests are managed.\n *\n * @param {String} id\n * @param {Promise<Response>} fetchResponsePromise\n */\n\nfunction setPrefetchedXHR(id, fetchResponsePromise) {\n  window.prefetched_xhrs = window.prefetched_xhrs || {};\n  window.prefetched_xhrs[id] = fetchResponsePromise;\n}\n/**\n * Remove all prefetched requests from storage. This function is intended for\n * specs so that they can clean up after assertions without needing awareness\n * of the implementation details for how prefetched requests are managed.\n */\n\nfunction clearPrefetchedXHRs() {\n  delete window.prefetched_xhrs;\n}\n/**\n * Transforms a `fetch` request into something that looks like an `axios` response\n * with a `.data` and `.headers` property, so you can pass it to our parseLinkHeaders stuff\n *\n * @param {Promise<Response>} fetchRequest\n * @returns {Promise<import(\"axios\").AxiosResponse>}\n */\n\nfunction asAxios(fetchRequest, type = 'json') {\n  if (!fetchRequest) return;\n  return fetchRequest.then(checkStatus).then(res => res.clone()[type]().then(data => {\n    return {\n      data,\n      headers: {\n        link: res.headers.get('Link')\n      }\n    };\n  }));\n}\n/**\n * Takes a `fetch` request and returns a promise of the json data of the response\n *\n * @param {Promise<Response>} fetchRequest\n * @returns {Promise<JSON_data>}\n */\n\nfunction asJson(fetchRequest) {\n  if (!fetchRequest) return;\n  return fetchRequest.then(checkStatus).then(res => res.clone().json());\n}\n/**\n * Takes a `fetch` request and returns a promise of the text of the response\n *\n * @param {Promise<Response>} fetchRequest\n * @returns {Promise<USVString>}\n */\n\nfunction asText(fetchRequest) {\n  if (!fetchRequest) return;\n  return fetchRequest.then(checkStatus).then(res => res.clone().text());\n}\n/**\n * filter a response to raise an error on a 400+ status\n *\n * @param {Promise<Response>} response\n * @returns {Promise<Response>}\n */\n\nfunction checkStatus(response) {\n  if (response.status < 400) {\n    return response;\n  } else {\n    const error = new Error(response.statusText);\n    error.response = response;\n    throw error;\n  }\n} // these are duplicated in application_helper.rb#prefetch_xhr\n// because we don't have a good pattern for sharing them yet.\n// If you change these defaults, you should probably cascade that change\n// to that ruby location\n\nconst defaultFetchOptions = {\n  credentials: 'same-origin',\n  headers: {\n    Accept: 'application/json+canvas-string-ids, application/json',\n    'X-Requested-With': 'XMLHttpRequest',\n    'X-CSRF-Token': Object(_instructure_get_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"])('_csrf_token')\n  }\n};\n\n//# sourceURL=webpack:///./packages/js-utils/es/prefetched_xhrs.js?");

/***/ }),

/***/ "uloQ":
/*!**********************************************!*\
  !*** ./ui/shared/alerts/react/FlashAlert.js ***!
  \**********************************************/
/*! exports provided: default, showFlashAlert, destroyContainer, showFlashError, showFlashSuccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FlashAlert; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showFlashAlert\", function() { return showFlashAlert; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"destroyContainer\", function() { return destroyContainer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showFlashError\", function() { return showFlashError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showFlashSuccess\", function() { return showFlashSuccess; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-dom */ \"i8i4\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _canvas_i18n__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/i18n */ \"HGxv\");\n/* harmony import */ var _instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-alerts */ \"spba\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-a11y-content */ \"9+/z\");\n/* harmony import */ var _instructure_ui_motion__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-motion */ \"Nl9J\");\n/*\n * Copyright (C) 2017 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Flash alerts, especially for ajax error messages\n * Typical usage:\n * import {showFlashError} from './FlashAlert'\n * ...\n * axios.put(url, data).then((response) => {\n *     // do something with response\n *   }).catch(showFlashError(your_error_message))\n *\n * showFlashError() with no argument shows a generic message\n *\n * On error, will display an inst-ui Alert at the top of the page\n * with an error message and \"Details\" button. When the user clicks\n * the button, it shows error details extracted from the axios Error\n *\n * You could also import the lower level showFlashAlert function or\n * the FlashAlert component if you need more control\n *\n * showFlashAlert({ err, message, type }, onCloseCallback)\n *  err: error object\n *  message: user-facing message\n *  type: one of ['info', 'success', 'warning', 'error']\n *        default is 'info' unless an error object is passed in, else is 'error'\n */\n\n\n\n\n\n\n\n\n\nconst I18n = Object(_canvas_i18n__WEBPACK_IMPORTED_MODULE_3__[\"useScope\"])('ajaxflashalert');\nconst messageHolderId = 'flashalert_message_holder'; // specs fail if I reuse jquery's elements\n\nconst screenreaderMessageHolderId = 'flash_screenreader_holder';\nconst timeout = 10000; // An Alert with a message and \"Details\" button which surfaces\n// more info about the error when pressed.\n// Is displayed at the top of the document, and will close itself after a while\n\nclass FlashAlert extends react__WEBPACK_IMPORTED_MODULE_0___default.a.Component {\n  constructor(props) {\n    super(props);\n\n    this.showDetails = () => {\n      this.setState({\n        showDetails: true\n      });\n      clearTimeout(this.timerId);\n      this.timerId = setTimeout(() => this.closeAlert(), this.props.timeout);\n    };\n\n    this.closeAlert = () => {\n      this.setState({\n        isOpen: false\n      }, () => {\n        setTimeout(() => {\n          clearTimeout(this.timerId);\n          this.props.onClose();\n        }, 500);\n      });\n    };\n\n    this.state = {\n      showDetails: false,\n      isOpen: true\n    };\n    this.timerId = 0;\n  }\n\n  getLiveRegion() {\n    // return element where flash screenreader messages go.\n    // create if necessary\n    let liveRegion = document.getElementById(screenreaderMessageHolderId);\n\n    if (!liveRegion) {\n      liveRegion = document.createElement('div');\n      liveRegion.id = screenreaderMessageHolderId;\n      liveRegion.setAttribute('role', 'alert');\n      document.body.appendChild(liveRegion);\n    }\n\n    return liveRegion;\n  }\n\n  findDetailMessage() {\n    const err = this.props.error;\n    let a = err.message;\n    let b;\n\n    if (err.response) {\n      if (err.response.data) {\n        try {\n          if (Array.isArray(err.response.data.errors)) {\n            // probably a canvas api\n            a = err.response.data.errors[0].message;\n            b = err.message;\n          } else if (err.response.data.message) {\n            // probably a canvas api too\n            a = err.response.data.message;\n            b = err.message;\n          }\n        } catch (ignore) {\n          a = err.message;\n        }\n      }\n    }\n\n    return {\n      a,\n      b\n    };\n  }\n\n  renderDetailMessage() {\n    const {\n      a,\n      b\n    } = this.findDetailMessage();\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], {\n      as: \"p\",\n      fontStyle: \"italic\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], null, a), b ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"br\", null) : null, b ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], null, b) : null);\n  }\n\n  render() {\n    let details = null;\n\n    if (this.props.error) {\n      if (this.state.showDetails) {\n        details = this.renderDetailMessage();\n      } else {\n        details = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_7__[\"PresentationContent\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_5__[\"Button\"], {\n          variant: \"link\",\n          onClick: this.showDetails\n        }, I18n.t('Details'))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_7__[\"ScreenReaderContent\"], null, this.renderDetailMessage()));\n      }\n    }\n\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_motion__WEBPACK_IMPORTED_MODULE_8__[\"Transition\"], {\n      transitionOnMount: true,\n      in: this.state.isOpen,\n      type: \"fade\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_4__[\"Alert\"], {\n      variant: this.props.variant,\n      renderCloseButtonLabel: I18n.t('Close'),\n      onDismiss: this.closeAlert,\n      margin: \"small auto\",\n      timeout: this.props.timeout,\n      liveRegion: this.getLiveRegion,\n      transition: \"fade\",\n      screenReaderOnly: this.props.screenReaderOnly\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"p\", {\n      style: {\n        margin: '0 -5px'\n      }\n    }, this.props.message), details)));\n  }\n\n}\nFlashAlert.propTypes = {\n  onClose: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func.isRequired,\n  message: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string.isRequired,\n  error: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.instanceOf(Error),\n  variant: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.oneOf(['info', 'success', 'warning', 'error']),\n  timeout: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.number,\n  screenReaderOnly: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool\n};\nFlashAlert.defaultProps = {\n  error: null,\n  variant: 'info',\n  timeout,\n  screenReaderOnly: false\n};\nfunction showFlashAlert({\n  message,\n  err,\n  type = err ? 'error' : 'info',\n  srOnly = false\n}) {\n  function closeAlert(atNode) {\n    react_dom__WEBPACK_IMPORTED_MODULE_2___default.a.unmountComponentAtNode(atNode);\n    atNode.remove();\n  }\n\n  function getAlertContainer() {\n    let alertContainer = document.getElementById(messageHolderId);\n\n    if (!alertContainer) {\n      alertContainer = document.createElement('div');\n      alertContainer.classList.add('clickthrough-container');\n      alertContainer.id = messageHolderId;\n      alertContainer.setAttribute('style', 'position: fixed; top: 0; left: 0; width: 100%; z-index: 100000;');\n      document.body.appendChild(alertContainer);\n    }\n\n    return alertContainer;\n  }\n\n  function renderAlert(parent) {\n    react_dom__WEBPACK_IMPORTED_MODULE_2___default.a.render( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(FlashAlert, {\n      message: message,\n      timeout: Number.isNaN(parseInt(ENV.flashAlertTimeout, 10)) ? timeout : ENV.flashAlertTimeout,\n      error: err,\n      variant: type,\n      onClose: closeAlert.bind(null, parent) // eslint-disable-line react/jsx-no-bind\n      ,\n      screenReaderOnly: srOnly\n    }), parent);\n  }\n\n  const div = document.createElement('div'); // div.setAttribute('class', styles.flashMessage)\n\n  div.setAttribute('style', 'max-width:50em;margin:1rem auto;');\n  div.setAttribute('class', 'flashalert-message');\n  getAlertContainer().appendChild(div);\n  renderAlert(div);\n}\nfunction destroyContainer() {\n  const container = document.getElementById(messageHolderId);\n  const liveRegion = document.getElementById(screenreaderMessageHolderId);\n  if (container) container.remove();\n  if (liveRegion) liveRegion.remove();\n}\nfunction showFlashError(message = I18n.t('An error occurred making a network request')) {\n  return err => showFlashAlert({\n    message,\n    err,\n    type: 'error'\n  });\n}\nfunction showFlashSuccess(message) {\n  return () => showFlashAlert({\n    message,\n    type: 'success'\n  });\n}\n\n//# sourceURL=webpack:///./ui/shared/alerts/react/FlashAlert.js?");

/***/ })

}]);