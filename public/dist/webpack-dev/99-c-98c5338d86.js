(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([[99],{

/***/ "09oz":
/*!*****************************************************************************!*\
  !*** ./packages/canvas-rce/es/rce/plugins/shared/Upload/UploadFileModal.js ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _instructure_ui_modal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @instructure/ui-modal */ \"7I2A\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _instructure_ui_heading__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-heading */ \"nwNI\");\n/* harmony import */ var _instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-spinner */ \"cPO5\");\n/* harmony import */ var _instructure_ui_tabs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-tabs */ \"pjPr\");\n/* harmony import */ var _instructure_ui_toggle_details__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-toggle-details */ \"Bcfm\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _format_message__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../format-message */ \"NFDp\");\n/* harmony import */ var _rcs_api__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../rcs/api */ \"n/1O\");\n/* harmony import */ var _ImageOptionsForm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ImageOptionsForm */ \"587I\");\n/* harmony import */ var _UsageRightsSelectBox__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./UsageRightsSelectBox */ \"hxEk\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/*\n * Copyright (C) 2020 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst ComputerPanel = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.lazy(() => Promise.all(/*! import() */[__webpack_require__.e(29), __webpack_require__.e(43), __webpack_require__.e(65), __webpack_require__.e(79), __webpack_require__.e(84), __webpack_require__.e(3907)]).then(__webpack_require__.bind(null, /*! ./ComputerPanel */ \"0fYL\")));\nconst UrlPanel = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.lazy(() => Promise.resolve(/*! import() */).then(__webpack_require__.bind(null, /*! ./UrlPanel */ \"NVgN\")));\nconst UnsplashPanel = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.lazy(() => Promise.all(/*! import() */[__webpack_require__.e(41), __webpack_require__.e(43), __webpack_require__.e(94), __webpack_require__.e(3775)]).then(__webpack_require__.bind(null, /*! ./UnsplashPanel */ \"vnrf\")));\n\nfunction shouldBeDisabled({\n  fileUrl,\n  theFile,\n  unsplashData,\n  error\n}, selectedPanel, usageRightNotSet) {\n  if (error || usageRightNotSet && selectedPanel === 'COMPUTER') {\n    return true;\n  }\n\n  switch (selectedPanel) {\n    case 'COMPUTER':\n      return !theFile || theFile.error;\n\n    case 'UNSPLASH':\n      return !unsplashData.id || !unsplashData.url;\n\n    case 'URL':\n      return !fileUrl;\n\n    default:\n      return false;\n    // When in doubt, don't disable (but we shouldn't get here either)\n  }\n}\n\nconst UploadFileModal = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.forwardRef(({\n  editor,\n  contentProps,\n  trayProps,\n  onSubmit,\n  onDismiss,\n  panels,\n  label,\n  accept,\n  modalBodyWidth,\n  modalBodyHeight,\n  requireA11yAttributes = true\n}, ref) => {\n  var _contentProps$session;\n\n  const [theFile, setFile] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(null);\n  const [error, setError] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(null);\n  const [fileUrl, setFileUrl] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])('');\n  const [selectedPanel, setSelectedPanel] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(panels[0]);\n  const [unsplashData, setUnsplashData] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])({\n    id: null,\n    url: null\n  });\n  const [usageRightsState, setUsageRightsState] = react__WEBPACK_IMPORTED_MODULE_0___default.a.useState({\n    usageRight: 'choose',\n    ccLicense: '',\n    copyrightHolder: ''\n  }); // Image options props\n\n  const [altText, setAltText] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])('');\n  const [isDecorativeImage, setIsDecorativeImage] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(false);\n  const [displayAs, setDisplayAs] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])('embed'); // even though usage rights might be required by the course, canvas has no place\n  // on the user to store it. Only Group and Course.\n\n  const requiresUsageRights = (contentProps === null || contentProps === void 0 ? void 0 : (_contentProps$session = contentProps.session) === null || _contentProps$session === void 0 ? void 0 : _contentProps$session.usageRightsRequired) && /(?:course|group)/.test(trayProps.contextType);\n\n  function handleAltTextChange(event) {\n    setAltText(event.target.value);\n  }\n\n  function handleIsDecorativeChange(event) {\n    setIsDecorativeImage(event.target.checked);\n  }\n\n  function handleDisplayAsChange(event) {\n    setDisplayAs(event.target.value);\n  }\n\n  const submitDisabled = shouldBeDisabled({\n    fileUrl,\n    theFile,\n    unsplashData,\n    error\n  }, selectedPanel, requiresUsageRights && usageRightsState.usageRight === 'choose'); // Load the necessary session values, if not already loaded\n\n  const loadSession = contentProps.loadSession;\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(() => {\n    loadSession();\n  }, [loadSession]);\n  const source = trayProps.source || new _rcs_api__WEBPACK_IMPORTED_MODULE_10__[\"default\"]({\n    jwt: trayProps.jwt,\n    refreshToken: trayProps.refreshToken,\n    host: trayProps.host\n  });\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_2__[\"Modal\"], {\n    \"data-mce-component\": true,\n    as: \"form\",\n    label: label,\n    size: \"large\",\n    overflow: \"fit\",\n    onDismiss: onDismiss,\n    onSubmit: e => {\n      e.preventDefault();\n\n      if (submitDisabled) {\n        return false;\n      }\n\n      onSubmit(editor, accept, selectedPanel, {\n        fileUrl,\n        theFile,\n        unsplashData,\n        imageOptions: {\n          altText,\n          isDecorativeImage,\n          displayAs\n        },\n        usageRights: usageRightsState\n      }, contentProps, source, onDismiss);\n    },\n    open: true,\n    shouldCloseOnDocumentClick: true,\n    liveRegion: trayProps.liveRegion\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_2__[\"Modal\"].Header, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_3__[\"CloseButton\"], {\n    onClick: onDismiss,\n    offset: \"small\",\n    placement: \"end\"\n  }, Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Close')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_heading__WEBPACK_IMPORTED_MODULE_4__[\"Heading\"], null, label)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_2__[\"Modal\"].Body, {\n    ref: ref\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_tabs__WEBPACK_IMPORTED_MODULE_6__[\"Tabs\"], {\n    onRequestTabChange: (event, {\n      index\n    }) => setSelectedPanel(panels[index])\n  }, panels.map(panel => {\n    switch (panel) {\n      case 'COMPUTER':\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_tabs__WEBPACK_IMPORTED_MODULE_6__[\"Tabs\"].Panel, {\n          key: panel,\n          renderTitle: function () {\n            return Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Computer');\n          },\n          selected: selectedPanel === 'COMPUTER'\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__[\"Suspense\"], {\n          fallback: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_5__[\"Spinner\"], {\n            renderTitle: Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Loading'),\n            size: \"large\"\n          })\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ComputerPanel, {\n          editor: editor,\n          theFile: theFile,\n          setFile: setFile,\n          setError: setError,\n          label: label,\n          accept: accept,\n          bounds: {\n            width: modalBodyWidth,\n            height: modalBodyHeight\n          }\n        })));\n\n      case 'UNSPLASH':\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_tabs__WEBPACK_IMPORTED_MODULE_6__[\"Tabs\"].Panel, {\n          key: panel,\n          renderTitle: function () {\n            return 'Unsplash';\n          },\n          selected: selectedPanel === 'UNSPLASH'\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__[\"Suspense\"], {\n          fallback: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_5__[\"Spinner\"], {\n            renderTitle: Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Loading'),\n            size: \"large\"\n          })\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(UnsplashPanel, {\n          editor: editor,\n          setUnsplashData: setUnsplashData,\n          source: source,\n          brandColor: trayProps.brandColor,\n          liveRegion: trayProps.liveRegion\n        })));\n\n      case 'URL':\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_tabs__WEBPACK_IMPORTED_MODULE_6__[\"Tabs\"].Panel, {\n          key: panel,\n          renderTitle: function () {\n            return Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('URL');\n          },\n          selected: selectedPanel === 'URL'\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__[\"Suspense\"], {\n          fallback: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_5__[\"Spinner\"], {\n            renderTitle: Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Loading'),\n            size: \"large\"\n          })\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(UrlPanel, {\n          fileUrl: fileUrl,\n          setFileUrl: setFileUrl\n        })));\n    }\n\n    return null;\n  })), // We shouldn't show the accordions until the session data is loaded.\n  Object.keys(contentProps.session || {}).length > 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null, selectedPanel === 'COMPUTER' && requiresUsageRights && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_13__[\"View\"], {\n    as: \"div\",\n    role: \"group\",\n    borderColor: \"primary\",\n    borderWidth: \"0 0 small 0\",\n    padding: \"medium\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_toggle_details__WEBPACK_IMPORTED_MODULE_7__[\"ToggleDetails\"], {\n    defaultExpanded: true,\n    summary: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_heading__WEBPACK_IMPORTED_MODULE_4__[\"Heading\"], {\n      level: \"h3\"\n    }, Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Usage Rights (required)'))\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_UsageRightsSelectBox__WEBPACK_IMPORTED_MODULE_12__[\"default\"], {\n    usageRightsState: usageRightsState,\n    setUsageRightsState: setUsageRightsState,\n    contextType: trayProps.contextType,\n    contextId: trayProps.contextId,\n    showMessage: false\n  }))), /image/.test(accept) && requireA11yAttributes && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_13__[\"View\"], {\n    as: \"div\",\n    role: \"group\",\n    borderColor: \"primary\",\n    borderWidth: \"0 0 small 0\",\n    padding: \"medium\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_toggle_details__WEBPACK_IMPORTED_MODULE_7__[\"ToggleDetails\"], {\n    defaultExpanded: !requiresUsageRights,\n    summary: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_heading__WEBPACK_IMPORTED_MODULE_4__[\"Heading\"], {\n      level: \"h3\"\n    }, Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Attributes'))\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_ImageOptionsForm__WEBPACK_IMPORTED_MODULE_11__[\"default\"], {\n    id: \"upload-file-form\",\n    altText: altText,\n    isDecorativeImage: isDecorativeImage,\n    displayAs: displayAs,\n    handleAltTextChange: handleAltTextChange,\n    handleIsDecorativeChange: handleIsDecorativeChange,\n    handleDisplayAsChange: handleDisplayAsChange,\n    hideDimensions: true\n  }))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_modal__WEBPACK_IMPORTED_MODULE_2__[\"Modal\"].Footer, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_3__[\"Button\"], {\n    onClick: onDismiss\n  }, Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Close')), \"\\xA0\", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_3__[\"Button\"], {\n    variant: \"primary\",\n    type: \"submit\",\n    disabled: submitDisabled\n  }, Object(_format_message__WEBPACK_IMPORTED_MODULE_9__[\"default\"])('Submit'))));\n});\nUploadFileModal.propTypes = {\n  editor: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"object\"].isRequired,\n  contentProps: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"object\"],\n  trayProps: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"object\"],\n  onSubmit: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"func\"],\n  onDismiss: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"func\"].isRequired,\n  panels: Object(prop_types__WEBPACK_IMPORTED_MODULE_1__[\"arrayOf\"])(Object(prop_types__WEBPACK_IMPORTED_MODULE_1__[\"oneOf\"])(['COMPUTER', 'UNSPLASH', 'URL'])),\n  label: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"string\"].isRequired,\n  accept: Object(prop_types__WEBPACK_IMPORTED_MODULE_1__[\"oneOfType\"])([Object(prop_types__WEBPACK_IMPORTED_MODULE_1__[\"arrayOf\"])(prop_types__WEBPACK_IMPORTED_MODULE_1__[\"string\"]), prop_types__WEBPACK_IMPORTED_MODULE_1__[\"string\"]]),\n  modalBodyWidth: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"number\"],\n  modalBodyHeight: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"number\"],\n  requireA11yAttributes: prop_types__WEBPACK_IMPORTED_MODULE_1__[\"bool\"]\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (UploadFileModal);\n\n//# sourceURL=webpack:///./packages/canvas-rce/es/rce/plugins/shared/Upload/UploadFileModal.js?");

/***/ }),

/***/ "ErcB":
/*!************************************************************************!*\
  !*** ./packages/canvas-rce/es/rce/plugins/shared/Upload/UploadFile.js ***!
  \************************************************************************/
/*! exports provided: handleSubmit, UploadFile */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"handleSubmit\", function() { return handleSubmit; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UploadFile\", function() { return UploadFile; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-dom */ \"i8i4\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _instructure_ui_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/ui-utils */ \"Nd46\");\n/* harmony import */ var _indicatorRegion__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../indicatorRegion */ \"QUlp\");\n/* harmony import */ var _fileTypeUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../fileTypeUtils */ \"kyQv\");\n/* harmony import */ var _common_indicate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../common/indicate */ \"uTvJ\");\n/* harmony import */ var _StoreContext__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../StoreContext */ \"eHui\");\n/* harmony import */ var _bridge__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../bridge */ \"QV6e\");\n/* harmony import */ var _UploadFileModal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./UploadFileModal */ \"09oz\");\n/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n/**\n * Handles uploading data based on what type of data is submitted.\n */\n\nconst handleSubmit = (editor, accept, selectedPanel, uploadData, storeProps, source, afterInsert = () => {}) => {\n  _bridge__WEBPACK_IMPORTED_MODULE_8__[\"default\"].focusEditor(editor.rceWrapper); // necessary since it blurred when the modal opened\n\n  const {\n    altText,\n    isDecorativeImage,\n    displayAs\n  } = (uploadData === null || uploadData === void 0 ? void 0 : uploadData.imageOptions) || {};\n\n  switch (selectedPanel) {\n    case 'COMPUTER':\n      {\n        var _uploadData$usageRigh;\n\n        const {\n          theFile\n        } = uploadData;\n        const fileMetaData = {\n          parentFolderId: 'media',\n          name: theFile.name,\n          size: theFile.size,\n          contentType: theFile.type,\n          domObject: theFile,\n          altText,\n          isDecorativeImage,\n          displayAs,\n          usageRights: (uploadData === null || uploadData === void 0 ? void 0 : (_uploadData$usageRigh = uploadData.usageRights) === null || _uploadData$usageRigh === void 0 ? void 0 : _uploadData$usageRigh.usageRight) === 'choose' ? undefined : uploadData === null || uploadData === void 0 ? void 0 : uploadData.usageRights\n        };\n        let tabContext = 'documents';\n\n        if (Object(_fileTypeUtils__WEBPACK_IMPORTED_MODULE_5__[\"isImage\"])(theFile.type)) {\n          tabContext = 'images';\n        } else if (Object(_fileTypeUtils__WEBPACK_IMPORTED_MODULE_5__[\"isAudioOrVideo\"])(theFile.type)) {\n          tabContext = 'media';\n        }\n\n        storeProps.startMediaUpload(tabContext, fileMetaData);\n        break;\n      }\n\n    case 'UNSPLASH':\n      {\n        const {\n          unsplashData\n        } = uploadData;\n        source.pingbackUnsplash(unsplashData.id);\n        let editorHtml;\n\n        if (displayAs !== 'link' && /image/.test(accept)) {\n          editorHtml = editor.dom.createHTML('img', {\n            src: unsplashData.url,\n            alt: altText || unsplashData.alt,\n            role: isDecorativeImage ? 'presentation' : undefined\n          });\n        } else {\n          editorHtml = editor.dom.createHTML('a', {\n            href: unsplashData.url\n          }, altText || unsplashData.url);\n        }\n\n        editor.insertContent(editorHtml);\n        break;\n      }\n\n    case 'URL':\n      {\n        const {\n          fileUrl\n        } = uploadData;\n        let editorHtml;\n\n        if (displayAs !== 'link' && /image/.test(accept)) {\n          editorHtml = editor.dom.createHTML('img', {\n            src: fileUrl,\n            alt: altText,\n            role: isDecorativeImage ? 'presentation' : undefined\n          });\n        } else {\n          editorHtml = editor.dom.createHTML('a', {\n            href: fileUrl\n          }, altText || fileUrl);\n        }\n\n        editor.insertContent(editorHtml);\n        break;\n      }\n\n    default:\n      throw new Error('Selected Panel is invalid');\n    // Should never get here\n  }\n\n  const element = editor.selection.getEnd();\n  element.addEventListener('load', () => Object(_common_indicate__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(Object(_indicatorRegion__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(editor, element)));\n  afterInsert();\n};\nfunction UploadFile({\n  accept,\n  editor,\n  label,\n  panels,\n  onDismiss,\n  requireA11yAttributes = true,\n  trayProps,\n  onSubmit = handleSubmit\n}) {\n  const [modalBodyWidth, setModalBodyWidth] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(undefined);\n  const [modalBodyHeight, setModalBodyHeight] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(undefined);\n  const bodyRef = react__WEBPACK_IMPORTED_MODULE_0___default.a.useRef();\n  trayProps = trayProps || _bridge__WEBPACK_IMPORTED_MODULE_8__[\"default\"].trayProps.get(editor); // the panels get rendered inside tab panels. it's difficult for them to\n  // figure out how much space they have to work with, and I'd like the previews\n  // not to trigger scrollbars in the modal's body. Get the Modal.Body's size\n  // and to the ComputerPanel how much space it has so it can render the file preview\n\n  Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\n    if (bodyRef.current) {\n      // eslint-disable-next-line react/no-find-dom-node\n      const thebody = react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.findDOMNode(bodyRef.current);\n      const sz = thebody.getBoundingClientRect();\n      sz.height -= Object(_instructure_ui_utils__WEBPACK_IMPORTED_MODULE_3__[\"px\"])('3rem'); // leave room for the tabs\n\n      setModalBodyWidth(sz.width);\n      setModalBodyHeight(sz.height);\n    }\n  }, [modalBodyHeight, modalBodyWidth]);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_StoreContext__WEBPACK_IMPORTED_MODULE_7__[\"StoreProvider\"], trayProps, contentProps => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_UploadFileModal__WEBPACK_IMPORTED_MODULE_9__[\"default\"], {\n    ref: bodyRef,\n    editor: editor,\n    trayProps: trayProps,\n    contentProps: contentProps,\n    onSubmit: onSubmit,\n    onDismiss: onDismiss,\n    panels: panels,\n    label: label,\n    accept: accept,\n    modalBodyWidth: modalBodyWidth,\n    modalBodyHeight: modalBodyHeight,\n    requireA11yAttributes: requireA11yAttributes\n  }));\n}\nUploadFile.propTypes = {\n  onSubmit: prop_types__WEBPACK_IMPORTED_MODULE_2__[\"func\"],\n  onDismiss: prop_types__WEBPACK_IMPORTED_MODULE_2__[\"func\"].isRequired,\n  accept: Object(prop_types__WEBPACK_IMPORTED_MODULE_2__[\"oneOfType\"])([Object(prop_types__WEBPACK_IMPORTED_MODULE_2__[\"arrayOf\"])(prop_types__WEBPACK_IMPORTED_MODULE_2__[\"string\"]), prop_types__WEBPACK_IMPORTED_MODULE_2__[\"string\"]]),\n  editor: prop_types__WEBPACK_IMPORTED_MODULE_2__[\"object\"].isRequired,\n  label: prop_types__WEBPACK_IMPORTED_MODULE_2__[\"string\"].isRequired,\n  panels: Object(prop_types__WEBPACK_IMPORTED_MODULE_2__[\"arrayOf\"])(Object(prop_types__WEBPACK_IMPORTED_MODULE_2__[\"oneOf\"])(['COMPUTER', 'UNSPLASH', 'URL'])),\n  requireA11yAttributes: prop_types__WEBPACK_IMPORTED_MODULE_2__[\"bool\"],\n  trayProps: prop_types__WEBPACK_IMPORTED_MODULE_2__[\"object\"]\n};\n\n//# sourceURL=webpack:///./packages/canvas-rce/es/rce/plugins/shared/Upload/UploadFile.js?");

/***/ }),

/***/ "hxEk":
/*!**********************************************************************************!*\
  !*** ./packages/canvas-rce/es/rce/plugins/shared/Upload/UsageRightsSelectBox.js ***!
  \**********************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"17x9\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _format_message__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../format-message */ \"NFDp\");\n/* harmony import */ var _instructure_ui_simple_select__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/ui-simple-select */ \"fw+x\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/* harmony import */ var _instructure_ui_text_input__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-text-input */ \"/09A\");\n/*\n * Copyright (C) 2020 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\nconst CONTENT_OPTIONS = [{\n  display: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('Choose usage rights...'),\n  value: 'choose'\n}, {\n  display: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('I hold the copyright'),\n  value: 'own_copyright'\n}, {\n  display: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('I have obtained permission to use this file.'),\n  value: 'used_by_permission'\n}, {\n  display: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('The material is in the public domain'),\n  value: 'public_domain'\n}, {\n  display: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('The material is subject to an exception - e.g. fair use, the right to quote, or others under applicable copyright laws'),\n  value: 'fair_use'\n}, {\n  display: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('The material is licensed under Creative Commons'),\n  value: 'creative_commons'\n}];\n\nconst ShowCreativeCommonsOptions = ({\n  ccLicense,\n  setCCLicense,\n  licenseOptions\n}) => {\n  const onlyCC = licenseOptions.filter(license => license.id.indexOf('cc') === 0);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_4__[\"View\"], {\n    as: \"div\",\n    margin: \"medium 0\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_simple_select__WEBPACK_IMPORTED_MODULE_3__[\"SimpleSelect\"], {\n    renderLabel: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('Creative Commons License:'),\n    assistiveText: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('Use arrow keys to navigate options.'),\n    value: ccLicense,\n    onChange: (e, {\n      id\n    }) => setCCLicense(id)\n  }, onlyCC.map(license => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_simple_select__WEBPACK_IMPORTED_MODULE_3__[\"SimpleSelect\"].Option, {\n    key: license.id,\n    id: license.id,\n    value: license.id\n  }, license.name))));\n};\n\nconst ShowMessage = () => {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"alert\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n    className: \"icon-warning\"\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    style: {\n      paddingLeft: '10px'\n    }\n  }, Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(\"If you do not select usage rights now, this file will be unpublished after it's uploaded.\"))));\n};\n\nconst UsageRightsSelectBox = ({\n  contextType,\n  contextId,\n  showMessage: showMessageProp,\n  usageRightsState,\n  setUsageRightsState\n}) => {\n  const {\n    usageRight,\n    ccLicense,\n    copyrightHolder\n  } = usageRightsState;\n  const showCreativeCommonsOptions = usageRight === 'creative_commons';\n  const [licenseOptions, setLicenseOptions] = react__WEBPACK_IMPORTED_MODULE_0___default.a.useState([]);\n  const [showMessage, setShowMessage] = react__WEBPACK_IMPORTED_MODULE_0___default.a.useState(showMessageProp);\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(() => {\n    function getUsageRightsOptions() {\n      fetch(apiUrl()).then(res => res.text()).then(res => setLicenseOptions(JSON.parse(res))).catch(() => {});\n    }\n\n    function apiUrl() {\n      const context = contextType.replace(/([^s])$/, '$1s'); // pluralize\n\n      return `/api/v1/${context}/${contextId}/content_licenses`;\n    }\n\n    getUsageRightsOptions();\n  }, [contextType, contextId]);\n\n  function handleChange(value) {\n    setUsageRightsState(state => ({ ...state,\n      usageRight: value\n    }));\n    setShowMessage(showMessageProp && value === 'choose');\n  }\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_4__[\"View\"], {\n    as: \"div\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_4__[\"View\"], {\n    as: \"div\",\n    margin: \"medium 0\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_simple_select__WEBPACK_IMPORTED_MODULE_3__[\"SimpleSelect\"], {\n    renderLabel: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('Usage Right:'),\n    assistiveText: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('Use arrow keys to navigate options.'),\n    onChange: (e, {\n      id\n    }) => {\n      handleChange(id);\n    },\n    value: usageRight\n  }, CONTENT_OPTIONS.map(contentOption => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_simple_select__WEBPACK_IMPORTED_MODULE_3__[\"SimpleSelect\"].Option, {\n    key: contentOption.value,\n    id: contentOption.value,\n    value: contentOption.value\n  }, contentOption.display)))), showCreativeCommonsOptions && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ShowCreativeCommonsOptions, {\n    ccLicese: ccLicense,\n    setCCLicense: license => setUsageRightsState(state => ({ ...state,\n      ccLicense: license\n    })),\n    licenseOptions: licenseOptions\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_4__[\"View\"], {\n    as: \"div\",\n    margin: \"medium 0\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text_input__WEBPACK_IMPORTED_MODULE_5__[\"TextInput\"], {\n    renderLabel: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('Copyright Holder:'),\n    value: copyrightHolder,\n    onChange: (e, value) => setUsageRightsState(state => ({ ...state,\n      copyrightHolder: value\n    })),\n    placeholder: Object(_format_message__WEBPACK_IMPORTED_MODULE_2__[\"default\"])('(c) 2001 Acme Inc.')\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_4__[\"View\"], {\n    as: \"div\",\n    margin: \"medium 0\"\n  }, showMessage && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ShowMessage, null)));\n};\n\nUsageRightsSelectBox.propTypes = {\n  usageRightsState: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.shape({\n    ccLicense: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,\n    usageRight: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.oneOf(Object.values(CONTENT_OPTIONS).map(o => o.value)),\n    copyrightHolder: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string\n  }),\n  setUsageRightsState: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,\n  showMessage: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool,\n  contextType: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,\n  contextId: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string, prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.number])\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (UsageRightsSelectBox);\n\n//# sourceURL=webpack:///./packages/canvas-rce/es/rce/plugins/shared/Upload/UsageRightsSelectBox.js?");

/***/ })

}]);